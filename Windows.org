* Windows
** Version
*** Windows 7
*** Windows 10
*** Windows Server 2012 R2
**** Server Manager サーバーマネージャー
***** Add Roles and Features Wizard
- Role-based or feature-based installation / 役割ベースまたは機能ベースのインストール
- Remote Desktop Services installation / リモートデスクトップ サービスのインストール
** Shell
*** cmd
**** Command
***** Internals / 内部コマンド
- helpで確認
****** assoc
****** attrib
****** break
****** bcdedit
****** cacls
- 
  ファイルやフォルダに対して設定されているACLの内容を確認したり、
  変更するために利用するコマンドラインのツール。

****** call
****** cd
****** chcp
****** chdir
****** chkdsk
****** chkntfs
****** cls
- 画面上の文字を消去する。
  POSIX系shellだとclearかCtr+l。

****** cmd
****** color
****** comp
****** compact
****** convert
****** copy
****** date
****** del
****** dir
****** diskcomp
****** diskcopy
****** diskpart
****** doskey
****** drivequery
****** echo
****** endlocal
- バッチプログラムで一時的に変更した環境変数のローカル化を終了する。
****** erase
****** exit
****** fc
- fc (option) [file1] [file2]
  2つのファイルを比較して相違点を表示する。
- /L
  テキストファイルとして比較する。
- /B
  バイナリファイルとして比較する
- /A
  最初と最後の行のみ表示する
- /LB(行数)
  (行数)以上続いた場合に比較をやめる。

****** find
****** findstr
****** for
- FOR %変数 IN (セット) DO コマンド [コマンドパラメーター]
  指定されたコマンドをファイル セットの各ファイルに対して実行する
  - %変数 : 単一文字の置き換え可能なパラメーターを指定
  - (セット) : ファイル セットを指定する。ワイルドカードを使用可能。
  - コマンド : 各ファイルごとに実行するコマンドを指定
  - コマンドパラメーター : 指定されたコマンドのパラメーターまたはスイッチを指定する
- バッチプログラムでは、%変数の代わりに%%変数を使用する。
******* Switch
******** /D
******** /R
******** /L
******** /F
****** format
****** fsutil
******* Commands1
******** 8dot3name
******** behavior
- ファイルシステムの動作の制御
********* Commands2
********** query
- パラメータを照会
*********** Options
************ AllExtChar
************ BugcheckOnCorrupt
************ Disable8dot3
************ DisableCompression
************ DisableEncryption
************ DisableLastAccess
************ EncryptPagingFile
************ MftZone
************ MemoryUsage
************ QuotaNotify
************ SymlinkEvaluation
- シンボリックリンクの許可設定を表示
************ DisableDeleteNotify
********** set
- パラメータを変更
*********** Options
************ SymlinkEvaluation
- 許可設定を変更。
  R2R:1でRemote to remoteのlinkを許可とする。
******** dirty
******** file
******** fsinfo
******** hardlink
******** objectid
******** quota
******** repair
******** reparsepoint
******** resource
******** sparse
******** transaction
******** usn
******** volume
****** ftype
****** goto
****** gpresult
****** graptbal
****** help
- 
  コマンドの一覧を取得できる。
  内部コマンドも外部コマンドもあると思われる。

****** icals
****** if
******* defined
- 環境変数が設定されているかチェックするには、DEFINEDを使う。
- ex) 
    IF DEFINED ENV echo OK
- 
  [[http://orangeclover.hatenablog.com/entry/20110127/1296135692][バッチファイル/コマンドプロンプトで環境変数が設定されているかチェックする方法]]

******* Link
- tmp
  - [[http://qiita.com/sawa_tsuka/items/8edf3d3d33a0ae86cb5c][.bat（バッチファイル）のifコマンド解説。 - Qiita]]
****** label
****** md
****** mkdir
****** mklink
- MKLINK [[/D] | [/H] | [/J]] link target
  シンボリックリンクを作成する。
******* /D
- ディレクトリのシンボリックリンクを作成する。
  デフォルトはファイルのシンボリックリンクを作成する。
******* /H
- シンボリックリンクでなくハードリンクを作成する
******* /J
- ディレクトリジャンクションを作成する。
****** mode
****** more
****** move
****** penfiles
****** path
****** pause
****** popd
****** print
****** prompt
****** pushd
****** rd
****** recover
****** rem
****** ren
****** rename
****** replace
****** rmdir
****** robocopy
- 
  フォルダを同期するためのコマンド。
  Robust File Copyの略で、堅牢で確実なファイル・コピーという意味を持つ。
  コマンドラインでなくGUIから使いたい場合は、richcopyが利用できる。

- source dest files (option)
  sourceがコピー元、destがコピー先、filesでコピーするファイルを指定する。
  filesはワイルドカード指定可能で、規定値は*.*。

- /S
  サブディレクトリをコピーするが、空のディレクトリはコピーしない。
  
- /E
  空のサブディレクトリを含むサブディレクトリをコピーする。

- /LEV:n
  コピー元ディレクトリツリーの上位nレベルのみをコピーする。

- /MIR
  2つのフォルダを同期させる。
  destファイルにsourceにないファイルがあれば削除し、古いファイルがあれば上書きされる。
  /purgeと/sを組み合わせた挙動と同じ。

- /COPY:コピーフラグ
  ファイルにコピーする情報
  D:データ、A:属性、T:タイムスタンプ

- /TS
  出力にコピー元ファイルのタイムスタンプを含める

- /FP
  出力にファイルの完全なパス名を含める

- /BYTES
  サイズをバイトで出力する

- /TEE
  コンソールウィンドウとログファイルに出力する

****** set
- SET [変数名=[文字列]]
  環境変数を表示、設定、または削除する。

- 現在の環境変数を表示するには、パラメータを指定せず"SET"のみ入力する。
- 変数名のみを指定して実行すると、プレフィックスが一致するすべての変数の値が表示される。
  例えば、"SET P"とすると、'P'で始まるすべての変数が表示される。
******* Switch スイッチ
******** /A
- SET /A 式
  等号の右側の文字列が、評価する数式であることを指定する。
******** /P
- SET /P 変数=[プロンプト文字列]
  ユーザによって入力された入力行を変数の値として設定できるようにする。
****** setlocal
- 
  バッチファイルでの環境変数のローカル化を開始する。
  以前の設定を復元するにはENDLOCALを実行する。
  バッチスクリプトが終了すると、そのバッチスクリプトで発行されたSETLOCALコマンドに対し、
  暗黙のENDLOCALが実行される。

****** sc
- Service Control
  SC is a command line program used for communicating with the Service Control Manager and services.
- Usage:
  sc <server> [command] [service name] <options>...

******* Commands
******** query
- サービスの状態を照会したりサービスの種類ごとに状態を列挙したりする。
******** queryex
******** start
******** pause
******** interrogate
******** continue
******** stop
******** config
- 設定を変更する
  sc config ServiceName option= value
********* Options
********** start
- values
  - auto
  - boot
  - system
  - demand : manualの意
  - disabled
  - delayed-auto : 遅延自動起動
********** password
********** error
******** sdshow
- Displays the service's security descriptor in SDDL format.
  サービスセキュリティ記述子をSDDL形式で表示する
- Usage:
  sc <server> sdshow <service name> <showrights>
******** sdset
- Sets a service's security descriptor.
****** schtasks
****** shift
****** shutdown
****** sort
****** start
****** subst
****** systeminfo
****** tasklist
****** time
****** title
****** tree
****** type
****** ver
****** verify
****** vol
****** xcopy
****** wmic
- System Programのwbemも参照。
***** Externals / 外部コマンド
- "System Programs"等を参照
***** ネットワークコマンド
****** arp
- 
  OSが管理しているAPRテーブルを表示したり削除したりするコマンド。
  ARPテーブルは、IPアドレスとMACアドレスを関連付けた一覧。

- -a
  ARPテーブルを表示する

- -d IPアドレス
  指定したIPアドレスのエントリーを削除する

****** getmac
- 
  ネットワークにつながっている別のWindowsのMACアドレスを調べる。
  getmacを使うには管理者権限が必要なので、

- /s target /u username /p password
  サーバ名、管理者のユーザ名、パスワードを指定して、マックアドレスを確認する。

****** hostname
- 
  現在のホスト名を出力する

****** ipconfig
- 
  コンピュータのネットワーク設定情報を表示する

- /all
  すべてのNIC情報を表示する

- /release
  すべてのNICのIPv4のIPアドレスを開放する

- /renew
  すべてのNICのIPv4のIPアドレスを更新する

- /displaydns
  DNSリゾルバのキャッシュを表示する

- /flushdns
  DNSリゾルバのキャッシュをクリアする

****** nbtstat
- 
  Windowsネットワークを管理するためのコマンド。
  NBTとは"NetBIOS over TCP/IP"のこと。

- -c
  キャッシュしている情報を表示する

- -R
  キャッシュ内容をクリアする

- -n
  自分自身の情報を表示する

****** net
- 
  ネットワーク関係の設定を行ったり、現在の状態を表示させたりするために使われるコマンド。
  サブコマンドをいれずに使うとサブコマンド一覧が表示される。
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/258netcommand/netcommand.html][netコマンドの使い方 - @IT]]
  [[http://pasofaq.jp/windows/command/net7.htm][NETコマンド(Windows 7)]]

******* net use
- 
  共有リソースの使用/解除。net shareされたネットワーク上のリソースをローカルで使う場合に使う。

******* net share
- 
  共有リソースの公開/公開停止。ローカルのリソースを公開して、外部のマシンでnet useできるようにする。

******* net view
- 
  リソースが共有されているマシンの列挙や、特定のマシンが公開している共有リソースの一覧を調べる

******* net file
- 
  使用されているファイルの一覧の表示/強制終了。
  net shareで公開されたリソースのうち、どのようなファイルが実際に外部マシンで利用されているか調べる。

******* net session
- 
  ユーザアカウントに対するログオンやパスワードの要件の表示/強制終了

******* net print

******* net user

******* net accounts

******* net group

******* net computer

******* net start
- サービスの表示/開始

******* net stop
- 
  サービスの停止

******* net pause
- 
  サービスの一時停止

******* net continue
- 
  サービスの再開

******* net name
- 
  NetBIOS名の表示・追加。
  新しく追加された名前はnet sendコマンドの宛先として利用できる。

******* net send
- 指定されたユーザやコンピュータに対するメッセージの送信

******* net config
- 
  サーバ・サービスやワークステーション・サービスに関する情報の表示/設定

******* net sattistics
- 
  ネットワーク・プロトコルやリソースの公開/共有サービスに対する統計情報の表示

******* net time
- 
  時間情報の表示や外部との同期

******* net help
- 
  各コマンドの使い方の表示

******* net helpmsg
- 
  エラー番号に対する詳しいエラーメッセージの表示

****** netsh
- 
  netsh（ネットシェル）は、コンピュータのネットワーク設定情報を書き換えるコマンド。
  対話型と結果表示型、どちらも可能。
  Win純性のみでパケットのキャプチャを取得する場合にも利用。

- ?
  コマンド一覧が表示される

- exit
  終了する

******* Commands
******** ?
******** add
******** Advfirewall
******** bridge
******** delete
******** dump
******** exec
******** firewall
********* ?
********* add
- adds firewall configuration
********* delete
********* dump
********* help
********* set
********* show
******** help
******** http
******** trace
- パケットキャプチャを取得する。
  Microsoft Message Analyzerで解析が可能。

****** netstat
- 
  コンピュータの通信状況を一覧表示する。
  どのコンピュータとどんなプロトコルを使って何番ポートで通信しているかわかる。
  標準設定では、相手のコンピュータはホスト名、プロトコルはウェルノウンポートのプロトコル名で表示される。

- -a
  すべての接続とリッスンポートを表示する
- -n
  実行結果にコンピュータやプロトコル名を使わず、IPアドレスとポート番号で表示する
- -o
  Displays the owning process ID associated with each connection.
- -s
  プロトコルごとの統計を表示する。

****** nslookup
- 
  DNSサーバと通信して名前解決の「正引き」や「逆引き」を行うコマンド。
  IPアドレスかドメイン名を入力する。

****** pathping
- 
  ノード間のネットワークの状態を確認する。
  pingとtracertを組み合わせたようなイメージ。

****** ping
- 
  ICMPのサブコマンドechoを使った、単純なパケット通信テストプログラム。
- -t
  中断されるまでホストをpingする
- -n 要求数
  送信するエコー要求数を設定する

****** route
- ROUTE [-f] [-p] [-4|-6] command [destination] [MASK netmask] [gateway] [METRIC metric] [IF interface]
  ルーティングテーブルに関する情報を表示、または変更する。

******* Options
******** -f
- デフォルトゲートウェイを含む全ての静的ルーティング情報を消去する。

******** -p
- Addコマンドと併用された場合、システムの再起動後もルートが維持される。
******** -4
- IPv4の使用を強制する
******** -6
- IPv6の使用を強制する
******** command
- 以下のいずれか
  - PRINT
  - ADD
  - DELETE
  - CHANGE
******* Commands
- add|change|delete 宛先アドレス [mask ネットマスク] ゲートウェイ
  指定したルーティング情報を追加、変更、消去する。

- print
  ルーティング情報を表示する。

****** telnet
- 
  ネットワーク越しに別のコンピュータを操作するコマンド。
  Vista以降はコントロールパネルで有効化する必要がある。
  平文で送信されるので、使う範囲はLAN内に限定するべき。

****** tracert
- 
  実行するコンピュータから通信相手までの経路上にあるルータを一覧表示するコマンド。
  pingと同様ICMPのエコー要求・応答を利用している。
  TTLが1からスタートし、1つずつ大きくして経路上のルータを一覧表示する機能。

****** 外部link

- [[http://itpro.nikkeibp.co.jp/article/COLUMN/20060224/230618/][管理者必見！ネットワーク・コマンド集]]
- [[http://itpro.nikkeibp.co.jp/article/COLUMN/20131219/525889/][最重要ネットコマンド10]]
- [[http://blog.asial.co.jp/1157][使えると便利なWindowsネットワークコマンド]]

***** Linuxとの比較
- 
  |-------------+---------|
  | Linux shell | Win cmd |
  |-------------+---------|
  | cat         | type    |
  | clear       | cls     |
  | cp          | copy    |
  | ls          | dir     |
  | mv          | move    |
  | pwd         | cd      |
  | rm          | del     |
  |-------------+---------|

**** etc
***** IF文の複数条件指定
- 

  ANDやORに相当する機能はない。ただし、AND条件であればIF文を並べて記述できる。
  ex:) IF %A% == 1 IF %B% == 2 (
         REM 1かつ2のAND条件
     ) ELSE (
         それ以外
     )
- 
  [[http://capm-network.com/?tag=Windows%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%88%B6%E5%BE%A1%E6%A7%8B%E6%96%87][CapmNetwork Windowsバッチファイル制御構文]]

***** 処理の途中で改行を入れる
- 
  バッチファイルでのエスケープシーケンスは「^(hat)」なので、
  改行前に^をおくと複数行を1行として扱える。
  ex:) IF %ABCDEFGHIJKLM% ==1 ^
       IF %NOPQRSTUVWXYZ% ==2 (
         REM 処理
     )
- [[http://orangeclover.hatenablog.com/entry/20100810/1281450669][みちしるべ バッチファイルで長い1行の処理を改行を入れて複数行に分けて書きたい]]
- [[http://pf-j.sakura.ne.jp/program/dos/doscmd/str_circumflex.htm][ProgrammingField DOSコマンド一覧 ^(ハット記号)]]

***** 環境変数の消し方
- 
  "SET 変数="とする。
  たとえば変数XYZを初期化したければ、"set XYZ="でよい。

- [[http://orangeclover.hatenablog.com/entry/20090826/1251293551][みちしるべ 3.環境変数 (1)環境変数の使い方 〜意外に削除の仕方はしらない人が多い〜 【コマンドプロンプト、バッチファイルを使わなきゃならなくなった人向けのメモ】]]

***** バッチでの標準入力待ち
- 
  "SET /P 変数=出力文字列"、という感じの構文。
  たとえば"set /P var=好きな英数字を入力してください。"とすると、
  "好きな英数字を入力してください。"と画面に出力された後入力待ちになり、
  改行するまでの文字列がvarに格納される。
  バッチファイルでユーザーに入力させた値を取得する

***** Batchで日時を入力
- 
  %date%, %time%を使えばよいが、%time%は一桁時のときスペースを入れてくるため、
  スペースを0に置換する等の手段を取る必要がある。
  ex: echo %time% -> " 9:20:30.93"

- ex
  rem ***日時定義***
  set today=%date:/=%
  set time_tmp=%time: =0%
  set now=%today%%time_tmp:~0,2%%time_tmp:~3,2%%time_tmp:~6,2%

*** WSH
- Windows Script Host
- Windows環境でスクリプトを実行するための環境。
  標準では、VBScriptとJScriptを利用できる。
**** Programs
***** cscript.exe
***** wscript.exe
**** Objects
***** Basic Objects
****** WScript
****** WshArguments
****** WshController
****** WshEnvironment
****** WshNetwork
****** WshShell
****** WshShortcut
****** WshSpecialFolders
****** WshUrlShortcut
****** FileSystemObject
***** Win OS Objects
****** ADODB.Connection
****** ADODB.Stream
****** XMLHTTP
****** CDO.Message
****** InternetExplorer.Application
****** Shell.Application
****** ADSI (Active Directory Service Interfaces)
****** WMI (Windows Management Instrumentation)
**** Memo
***** 文字コード
- UTF-8では実行時にエラーが出た。設定方法はあるかもしれない。
  Shift_JISにしたところ問題なく実行できた。
**** Link
- [[https://msdn.microsoft.com/ja-jp/library/cc364455.aspx][Windows Script Host - Developer Network]]
- [[http://www.atmarkit.co.jp/ait/articles/0606/02/news116.html][基礎解説 演習方式で身につけるチェック式WSH超入門 - @IT]]
- [[http://news.mynavi.jp/articles/2009/01/25/wsh/][ゼロからはじめるWindows Script Host - 基本編 - マイナビニュース]]
*** PowerShell
- [[file:PowerShell.org][PowerShell.org]]
*** MSYS2
**** pacman
- [[file:Linux.org][Linux.org(PackageManagement/pacman参照)]]
**** Commands
***** cygpath
- Convert Unix and Windows format paths, or output system path information.
- Usage:
  - cygpath (-d|-m|-u|-w|-t TYPE) [-f FILE] [OPTION]... NAME...

****** Options
******* Output
******** -d, --dos
******** -m, --mixed
******** -M, --mode
******** -u, --unix
- default
  print Unix form of NAMEs
******** -w, --windows
******** -t, --type TYPE
**** Memo
***** PATHを引き継ぐ
- Windowsの環境変数"MSYS2_PATH_TYPE"にinheritを設定すると、設定が引き継がれる。
  [[http://chirimenmonster.github.io/2016/05/09/msys2-path.html][MSYS2でPATHが引き継がれない - めもらんだむ]]
***** ファイルパスの扱い
- Windows式のパスをそのまま入力すると、エスケープが処理されcdなどに失敗するが、
  ""(double quote)で囲って利用すると問題なく利用可能。
***** /home/userを上書き
- $HOME設定、/etc/passwd設定をしているものの、
  sshで~/.sshでなく/home/username/.sshが読まれていたので、fstabでmountする。
  - ex) C:/Users/username /home/username ntfs override,binary,auto 0 0
**** Link
- [[https://msys2.github.io/][MSYS2 installer]]
- [[https://sourceforge.net/p/msys2/wiki/Home/][MSYS2 - sourceforge]]
- [[https://github.com/Alexpux/MSYS2-packages][Alexpux/MSYS2-packages - github]]
*** Cygwin
**** Command
***** Cygutils
****** cygstart
- start a program or open a file or URL
  
** System Programs
*** System32
**** Direct
***** exe
****** CUI
******* cacls.exe
- ファイルのアクセス制御リスト（ACL）を表示・変更する。
  使用が推奨されていない、icaclsの使用を推奨。
******* certutil.exe
******** Options
********* -hashfile
******* choice.exe
- choice[.exe] [/C <choices>] [/N] [/CS] [/T nnnn [/D c]] [/M <message>]
  - /C <choices>
    選択肢となる文字列を指定する。
  - /N
    選択肢と「？」を表示させない。
  - /CS
    選択肢の大文字小文字を区別する。
  - /T
    選択する時間を設定する。nnnnは制限時間の秒数。
  - /D
    Tで指定した時間が経過した際に選択される選択肢を指定する。
  - /M <message>
    メッセージを表示する。

- 1番目の選択肢を選ぶと1、n番目の選択肢を選ぶとnが終了コード（エラーコード）が返される。
  Ctrl+Cなどが押されると0、エラー時には255が返される。

- ex) choice /C YN /M "続行しますか"
      ⇒続行しますか [Y,N]?

******* cmd.exe
- コマンドプロンプト。
******* cmdkey.exe
- 
  保存されたユーザ名とパスワードの作成、表示、および削除を行う。

- /list{:targetname}
  資格情報を表示する

- /add(/genericも可)
  - /add:targetname /user:username /pass:password
  - /add:targetname /user:username /pass
  - /add:targetname /user:username
  - /add:targetname /smartcard
  
  - /smartcard


- /delete
  - /delete:targetname

  - /delete /ras
    RAS資格情報を削除する
  
******* cscript.exe
- コマンドライン用WSH。
******* eventcreate.exe
- This enables an admistrator to create a custom event ID and message in a specified event log.
  イベントログの追加に加え、イベントソースが存在しない場合は作成してくれる。
******* findstr.exe
- ファイルから文字列を検索する
******** Options
********* /C:文字列
- 指定した文字列からリテラル検索文字列として使用する
******* ftp.exe
******** !
******** ?
******** append
******** ascii
******** bell
******** binary
******** bye
******** cd
******** close
******** debug
******** delete
******** dir
******** disconnect
- disconnect server
******** get
******** glob
******** hash
******** help
******** lcd
******** ls
******** mdelete
******** mdir
******** mget
******** mkdir
******** mls
******** mput
******** open
- connect server
******** put
******** pwd
******** quit
- quit the "ftp" session
******** quote
******** recv
******** remotehelp
******** rename
******** rmdir
******** status
******** trace
******** type
******** user
******** verbose
******* gpresult.exe
- RSoP(ポリシーの結果セット)の情報を取得するときに使う。
  rsop.mscをコマンドライン上で確認するコマンド。
******** Options
********* /R
- 概要を表示
********* /V
- 詳細情報を表示
********* /Z
- さらに詳細情報を表示
******* gpupdate.exe
- ドメインコントローラーからげな次の最新のグループポリシーをロードし適用する。
  "secedit /refreshpolicy"とほぼ同じ。
- 即時反映は"gpupdate /force /wait:0"
******** Options
********* /Target:{Computer | User}
********* /Force
********* /Wait:{value}
********* /Logoff
********* /Boot
********* /Sync
******* icacls.exe
- Integrity Control Access Control List。
  ファイルやフォルダのアクセス制御リストを表示、修正、バックアップ、復元などが可能。
- icalcs <name> /save <acl file> 
- 名前が一致する全てのファイルとフォルダーのDACLを
******* NETSTAT.EXE
- "ネットワークコマンド"配下を参照
******* SecEdit.exe
- ローカルセキュリティポリシーをCUIで変更する。
******** Link
- https://orebibou.com/2013/09/secedit-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%AB%E3%82%88%E3%82%8B%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC/
******* reg.exe
- Registry操作
******** Operations
********* REG ADD key
- REG ADD key

- ex
  REG ADD "HKLM\SYSTEM\CurrentControlSet\services\eventlog\Application\Revenue Management Application" /v CustomSource /t REG_DWORD /d 1
********** Options
*********** /v valuename
*********** /d data
*********** /t type
************ Type
- REG_SZ
- REG_MULTI_SZ
- REG_EXPAND_SZ
- REG_DWORD
- REG_QWORD
- REG_BINARY
- REG_NONE
*********** /s separator
********* COPY
********* DELETE
********* QUERY
********* SAVE
********* RESTORE
********* LOAD
********* UNLOAD
********* COMPARE
********* EXPORT
********* IMPORT
********* FLAGS
******* tasklist.exe
- 現在アクティブなプロセスとそのPIDのリストが表示される。
  POSIXのpsみたいなもの。
******* systeminfo.exe 
- 
  システム情報を表示できる。cmd上でsysteminfo。CUI。
  デフォルトで対象はローカルコンピュータ。
  ただし/s servername, /u UserName, /p Passwordなどを入力すると、
  リモートの情報も取得できる。

******* where.exe
- プログラムの場所を返す
****** GUI
******* eventvwr.exe
- イベントビューアー
******* mmc.exe
- Microsoft管理コンソール Microsoft Management Console
******* mstsc.exe / リモートデスクトップ
******** Options
********* /admin
- コンソールセッションに接続する(RDC 6.1以降)
- Windows 2008以上では、Session 0がnon-interactiveとなったため、consoleセッションには接続できない模様。
  [[https://social.technet.microsoft.com/Forums/lync/en-US/5895015a-d041-441e-83b3-4b0c4c74169a/windows-server-2012-console-session?forum=winserverTS][Windows server 2012 Console session - Lync TechCenter]]
  [[https://blogs.technet.microsoft.com/askperf/2007/04/27/application-compatibility-session-0-isolation/][Application Compatibility -Session 0 Isolation - Ask the Performance Team Blog]]
********* obsolete
********** /console
- RDC 5.x/6.0の場合に、コンソールセッションに接続する方法。
  6.1以降は/adminを利用。
  https://blogs.technet.microsoft.com/peterfi/2008/01/11/mstsc-console-is-now-mstsc-admin/
******* netplwiz.exe / ユーザアカウント
- 
  newplwiz.exeで開く。
  パスワード忘れてCMD立ち上げたときとかに役立つ。
******* notepad.exe
******** Memo
- UTF-8で保存すると勝手にBOMがつくので注意。
******* wscript.exe
- GUI実行用WSH。
****** System
******* conhost.exe
- コンソールウィンドウホスト。

****** tmp
AdapterTroubleshooter.exe
aitagent.exe
aitstatic.exe
alg.exe
appidcertstorecheck.exe
appidpolicyconverter.exe
appverif.exe
at.exe
AtBroker.exe
attrib.exe
audiodg.exe
auditpol.exe
autochk.exe
autoconv.exe
autofmt.exe
AxInstUI.exe
baaupdate.exe
bcdboot.exe
bcdedit.exe
BdeHdCfg.exe
BdeUISrv.exe
BdeUnlockWizard.exe
BitLockerWizard.exe
BitLockerWizardElev.exe
bitsadmin.exe
bootcfg.exe
bridgeunattend.exe
bthudtask.exe
calc.exe
CertEnrollCtrl.exe
certreq.exe
change.exe
charmap.exe
chglogon.exe
chgport.exe
chgusr.exe
chkdsk.exe
chkntfs.exe
cipher.exe
cleanmgr.exe
cliconfg.exe
clip.exe
cmdl32.exe
cmmon32.exe
cmstp.exe
cofire.exe
colorcpl.exe
comp.exe
compact.exe
CompatTelRunner.exe
CompMgmtLauncher.exe
ComputerDefaults.exe
consent.exe
control.exe
convert.exe
credwiz.exe
csrss.exe
ctfmon.exe
cttune.exe
cttunesvr.exe
CustomModeApp.exe
dccw.exe
dcomcnfg.exe
ddodiag.exe
Defrag.exe
DeviceDisplayObjectProvider.exe
DeviceEject.exe
DevicePairingWizard.exe
DeviceProperties.exe
DFDWiz.exe
dfrgui.exe
dialer.exe
diantz.exe
difx64.exe
dinotify.exe
diskpart.exe
diskperf.exe
diskraid.exe
Dism.exe
dispdiag.exe
DisplaySwitch.exe
djoin.exe
dllhost.exe
dllhst3g.exe
dnscacheugc.exe
doskey.exe
dpapimig.exe
DpiScaling.exe
dpnsvr.exe
DPTopologyApp.exe
driverquery.exe
drvinst.exe
dvdplay.exe
dvdupgrd.exe
dwm.exe
dxcpl.exe
dxdiag.exe
Dxpserver.exe
Eap3Host.exe
efsui.exe
EhStorAuthn.exe
esentutl.exe
eudcedit.exe
expand.exe
extrac32.exe
fc.exe
find.exe
finger.exe
fixmapi.exe
fltMC.exe
fontview.exe
forfiles.exe
fsquirt.exe
fsutil.exe
fvenotify.exe
fveprompt.exe
FXSCOVER.exe
FXSSVC.exe
FXSUNATD.exe
getmac.exe
GettingStarted.exe
GfxUIEx.exe
GfxUIHotKeyMenu.exe
gpscript.exe
grpconv.exe
hdwwiz.exe
help.exe
hkcmd.exe
hpservice.exe
hwrcomp.exe
hwrreg.exe
icardagt.exe
icsunattend.exe
IDTNGUI.exe
IDTNJ.exe
ie4uinit.exe
ieetwcollector.exe
ieUnatt.exe
iexpress.exe
igfxext.exe
igfxpers.exe
igfxsrvc.exe
igfxtray.exe
InfDefaultInstall.exe
ipconfig.exe
irftp.exe
iscsicli.exe
iscsicpl.exe
isoburn.exe
klist.exe
ksetup.exe
ktmutil.exe
label.exe
LocationNotifications.exe
Locator.exe
lodctr.exe
logagent.exe
logman.exe
logoff.exe
LogonUI.exe
lpksetup.exe
lpremove.exe
lsass.exe
lsm.exe
Magnify.exe
makecab.exe
manage-bde.exe
mblctr.exe
mcbuilder.exe
mctadmin.exe
MdRes.exe
MdSched.exe
mfevtps.exe
mfpmp.exe
microsoft.windows.softwarelogo.showdesktop.exe
MigAutoPlay.exe
mobsync.exe
mountvol.exe
mpnotify.exe
MpSigStub.exe
MRT.exe
msconfig.exe
msdt.exe
msdtc.exe
msfeedssync.exe
msg.exe
mshta.exe
msiexec.exe
msinfo32.exe
mspaint.exe
msra.exe
MsSpellCheckingFacility.exe
mtstocom.exe
MuiUnattend.exe
MultiDigiMon.exe
Narrator.exe
nbtstat.exe
ndadmin.exe
net.exe
net1.exe
netbtugc.exe
netcfg.exe
netdom.exe
netiougc.exe
Netplwiz.exe
NetProj.exe
netsh.exe
newdev.exe
nltest.exe
nslookup.exe
ntoskrnl.exe
ntprint.exe
ocsetup.exe
odbcad32.exe
odbcconf.exe
openfiles.exe
OptionalFeatures.exe
osk.exe
p2phost.exe
pcalua.exe
pcaui.exe
pcawrk.exe
pcwrun.exe
perfmon.exe
PkgMgr.exe
plasrv.exe
PnPUnattend.exe
PnPutil.exe
poqexec.exe
PortQry.exe
powercfg.exe
PresentationHost.exe
PresentationSettings.exe
prevhost.exe
print.exe
PrintBrmUi.exe
printfilterpipelinesvc.exe
PrintIsolationHost.exe
printui.exe
proquota.exe
psr.exe
PushPrinterConnections.exe
qappsrv.exe
qprocess.exe
query.exe
quser.exe
qwinsta.exe
rasautou.exe
rasdial.exe
raserver.exe
rasphone.exe
rdpclip.exe
rdpinit.exe
rdpshell.exe
rdpsign.exe
rdrleakdiag.exe
rdrmemptylst.exe
RDVGHelper.exe
ReAgentc.exe
recdisc.exe
recover.exe
regedt32.exe
regini.exe
Register-CimProvider.exe
RegisterIEPKEYs.exe
regsvr32.exe
rekeywiz.exe
relog.exe
RelPost.exe
repair-bde.exe
replace.exe
reset.exe
resmon.exe
RMActivate.exe
RMActivate_isv.exe
RMActivate_ssp.exe
RMActivate_ssp_isv.exe
RmClient.exe
Robocopy.exe
RpcPing.exe
rrinstaller.exe
rstrui.exe
runas.exe
rundll32.exe
RunLegacyCPLElevated.exe
runonce.exe
rwinsta.exe
sbunattend.exe
sc.exe
schtasks.exe
sdbinst.exe
sdchange.exe
sdclt.exe
sdiagnhost.exe
SearchFilterHost.exe
SearchIndexer.exe
SearchProtocolHost.exe
secinit.exe
services.exe
sethc.exe
SetIEInstalledDate.exe
setspn.exe
setupcl.exe
setupugc.exe
setx.exe
sfc.exe
shadow.exe
shrpubw.exe
shutdown.exe
sigverif.exe
slui.exe
smss.exe
SndVol.exe
SnippingTool.exe
snmptrap.exe
sort.exe
SoundRecorder.exe
spinstall.exe
spoolsv.exe
sppsvc.exe
spreview.exe
srdelayed.exe
StikyNot.exe
subst.exe
svchost.exe
sxstrace.exe
SyncHost.exe
syskey.exe
systeminfo.exe
SystemPropertiesAdvanced.exe
SystemPropertiesComputerName.exe
SystemPropertiesDataExecutionPrevention.exe
SystemPropertiesHardware.exe
SystemPropertiesPerformance.exe
SystemPropertiesProtection.exe
SystemPropertiesRemote.exe
systray.exe
tabcal.exe
takeown.exe
TapiUnattend.exe
taskeng.exe
taskhost.exe
taskkill.exe
taskmgr.exe
tcmsetup.exe
timeout.exe
TpmInit.exe
tracerpt.exe
tscon.exe
tsdiscon.exe
tskill.exe
TSTheme.exe
TsUsbRedirectionGroupPolicyControl.exe
TSWbPrxy.exe
TsWpfWrp.exe
typeperf.exe
tzutil.exe
ucsvc.exe
UI0Detect.exe
unlodctr.exe
unregmp2.exe
upnpcont.exe
UserAccountControlSettings.exe
userinit.exe
Utilman.exe
VaultCmd.exe
VaultSysUi.exe
vcsFPService.exe
vds.exe
vdsldr.exe
verclsid.exe
verifier.exe
vmicsvc.exe
vsjitdebugger.exe
vssadmin.exe
VSSVC.exe
w32tm.exe
waitfor.exe
wbadmin.exe
wbengine.exe
wecutil.exe
WerFault.exe
WerFaultSecure.exe
wermgr.exe
wevtutil.exe
wextract.exe
WFS.exe
whoami.exe
wiaacmgr.exe
wiawow64.exe
wimserv.exe
wininit.exe
winload.exe
winlogon.exe
winresume.exe
winrs.exe
winrshost.exe
WinSAT.exe
winver.exe
wisptis.exe
wksprt.exe
wlanext.exe
wlrmdr.exe
wowreg32.exe
WPDShextAutoplay.exe
wpnpinst.exe
write.exe
WSManHTTPConfig.exe
wsmprovhost.exe
wsqmcons.exe
wuapp.exe
wuauclt.exe
WUDFHost.exe
wusa.exe
xcopy.exe
xpsrchvw.exe
xwizard.exe
***** msc
- Microsoft Common Console Documentファイル。
  mscは、MMC用に作られた特殊なDDL。
  スナップインをどのように組み込むかを定義しているファイルで、中身はXML形式のテキストファイル。
****** azman.msc
****** certmgr.msc
****** comexp.msc
****** compmgmt.msc / Computer Management / コンピュータの管理
****** devmgmt.msc
****** diskmgmt.msc / Disk Management / ディスクの管理
- ディスクの管理。
  Windowsのスタートボタンを右クリック→disk managementを選択したり。
  computer managementのStorage項目としても選択可能。
******* Memo
******** ディスクがGPTかMBRか確認する
- ディスクを右クリック、プロパティ、ボリューム、パーティションのスタイル、に記載あり。
  http://www1.ark-info-sys.co.jp/support/etc/etc/check_mbr_gpt.html
****** eventvwr.msc / Event Viewer / イベントビューアー
****** fsmgmt.msc
****** gpedit.msc / ローカルグループポリシーエディター
****** lusrmgr.msc / ローカルユーザーとグループ（ローカル）
****** perfmon.msc / パフォーマンスモニター
****** printmanagement.msc
****** rsop.msc / Result Set of Policy / ポリシーの結果セット
****** secpol.msc / ローカルセキュリティポリシー
******* Console Tree
******** Security Settings
********* Account Policies / アカウントポリシー
********* Local Policies / ローカルポリシー
********* Windows Firewall with Advanced Security / セキュリティが強化されたWindowsファイアウォール
********* Network List Manager Policies / ネットワークリストマネージャーポリシー
********* Public Key Policies / 公開キーのポリシー
********* Software Restriction Policies / ソフトウェアの制限のポリシー
********* Application Control Policies / アプリケーション制御ポリシー
********* IP Security Policies on Local Computer / IPセキュリティポリシー（ローカルコンピューター）
********* Advanced Audit Policy Configuration / 監査ポリシーの詳細な構成
****** services.msc / サービス
****** SQLServerManager10.msc
****** taskschd.msc
****** tpm.msc
****** WF.msc
****** WmiMgmt.msc
****** tmp from msc.exe/Add or Remove Snap-ins
******* Active Directory Domains and Trusts
******* Active Directory Rights Management Services
******* Active Directory Sites and Services
******* Active Directory Users and Computers
******* ActiveX control
******* ADSI Edit
******* Authorization Manager
******* Certificate Templates
******* Certificates
******* Certification Authority
******* Component Services
******* Computer Management
******* Device Manager
******* DFS Management
******* DHCP
******* Disk Management
******* DNS
******* Enterprise PKI
******* Failover Cluster Manager
******* Failover Cluster Manager Host
******* File Server Resource Manager
******* Folder
******* Group Policy Object Editor
***** etc
****** winrm.cmd
- Windows Remote Management Command Line Tool
- Server限定の可能性あり
******* Usage
- winrm OPERATION RESOURCE_URI
******* OPERATIONS
******** winrm g[et] -?
******** winrm s[et] -?
******** winrm c[reate] -?
******** winrm d[elete] -?
******** winrm e[numerate] -?
******** winrm i[nvoke] -?
******** winrm id
******** winrm quickconfig -?
- Configures this machine to accept WS-Management requests from other machines.
**** wbem\
***** wmic.exe / WMI (Windows Management Instrumentation)
- 
  システム管理用インターフェイス。
  WBEMというシステム管理を目的とした標準仕様に従って、WinOSに実装、拡張したもの。
  wmicというCommandLineツールを使って情報を取得したり操作できる。
  "wmic qfe"として適用済みのKBを取得できる。
**** WindowsPowerShell\
***** v1.0
****** powershell.exe

*** Server
**** servermanagercmd.exe
**** oclist.exe
**** dcpromo.exe
** Files
*** pagefile.sys
- C:\pagefile.sys
  paging file.
- [[http://lifehacker.com/5426041/understanding-the-windows-pagefile-and-why-you-shouldnt-disable-it][Understanding the Windows Pagefile and Why You Shouldn't Disable It - lifehacker]]

*** hiberfil.sys
- C:\hiberfil.sys
  when hybernation is start, data on memory is moved this file.
** Settings
*** Control Panel
**** Win7
***** ユーザーアカウント
****** 資格情報の管理
******* 汎用資格情報
- 
  [[http://news.mynavi.jp/special/2009/windows7/081.html][第6章 Windows 7のセキュリティとメンテナンス - パスワードを一括管理する「資格情報マネージャー」 - マイナビ ニュース]]

- command
  cmdkey (/list, /add)
  [[http://blog.putise.com/windows%E3%81%AE%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E8%B3%87%E6%A0%BC%E6%83%85%E5%A0%B1%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E5%90%8D%E3%83%BB%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC/][Windowsのネットワーク資格情報(ユーザー名・パスワード)を記憶させる方法。コマンドもある - puti se blog]]

***** フォント
- フォントをここに置くと適用される。
*** Registry
**** Structure
***** HKEY_CLASSES_ROOT
- HKCR
  HKEY_LOCAL_MACHINE\Softwareのサブキー。
  エクスプローラを使用してファイルを開くときに正しいプログラムを起動するための情報が格納される。
***** HKEY_CURRENT_USER
- HKCU
  現在ログオンしているユーザの構成情報のルートが格納されている。
  現在ログオンしているユーザのフォルダ、画面の色、コントロールパネル設定などが格納される。
  HKEY_USERSのサブキー。
***** HKEY_LOCAL_MACHINE
- HKLM
  コンピュータに固有の構成情報が格納される。
****** SOFTWARE
****** SYSTEM
******* CurrentControlSet
******** Control
********* Keyboard Layout
********* Keyboard Layouts

******** Services
********* EventLog
********** Application
- イベントログソースが保存されている。
  Event Log Source
********* LanmanWorkstation
********** Parameters
*********** EnableNetBTForSmb2
- Win8, Win8.1, Win2012, Win2012R2でSMBバージョン2を使用して通信したい場合に1とする。
  Win10では使用できない。
*********** SMB1NATCompatibility
***** HKEY_USERS
- HKU
  コンピュータ上に読み込まれた有効なユーザプロファイルがすべて格納される。
****** .DEFAULT
******* Keyboard Layout
******** Preload
- local layoutが表示される
***** HKEY_CURRENT_CONFIG
- 
  システムの起動時にローカルコンピュータにより使用されるハードウェアプロファイルに関する情報が格納されている。
**** Type
- REG_BINARY
  バイナリ値
- REG_SZ
  文字列値。改行を含まない固定長文字列
- REG_EXPAND_SZ
  展開可能な文字列値。環境変数で展開される文字列(%~%)
- REG_MULTI_SZZ
  複数行文字列。改行を含む文字列
- REG_DWORD
  DWORD(32bit)値。32bit符号なし整数値
- REG_QWORD
  QWORD(64bit)値。64bit符号なし整数値
**** Tips
***** Dvorak
- HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts\00000411
  KBDJPN.DLL -> KBDDV.DLL
***** Default Settings
- HKEY_USERS\.DEFAULT\Keyboard Layout\Preloadに記載あり
  http://www.itprotoday.com/management-mobility/how-do-i-configure-default-keyboard-layout-during-login

***** caps<->ctrl
- HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout\Scancode Map(なければ作成)
- 値のデータ
  00 00 00 00 00 00 00 00
  03 00 00 00 1D 00 3A 00
  3A 00 1D 00 00 00 00 00 
  
- 内容
  00 00 00 00 : header version[4byte]
  00 00 00 00 : flags[4byte]
  03 00 00 00 : エントリ数、terimnate含む
  3A 00 1D 00 : 3A 00 -> 1D 00
  1D 00 3A 00 : 1D 00 -> 3A 00
  00 00 00 00 : terminate

- Link
  [[http://uguisu.skr.jp/Windows/winCaps.html][「Caps」と「Ctrl」の入れ替え]]

***** Keycode(106 keyboard) Scancode
  - ESC : 00 01
  - TAB : 00 0F
  - CapsLock : 00 3A
  - 左Shift : 00 2A
  - 右Shift : 00 36
  - 左Alt : 00 38
  - 右Alt : E0 38
  - 左Ctrl : 00 1D
  - 右Ctrl E0 1D
  - Enter : 00 1C
  - Del : E0 53
  - Backspace : 00 0E
  - Win右 : E0 5C
  - Win左 : E0 5B
  - 半角/全角 : 0x29
  - 変換 : 0x79
  - 無変換 : 0x78

****** Link(Scancode)
- [[https://www.win.tue.nl/~aeb/linux/kbd/scancodes.html#toc1][Keyboard scancodes]]
- [[https://ja.wikipedia.org/wiki/%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3%E3%82%B3%E3%83%BC%E3%83%89][スキャンコード - Wikipedia]]
- [[http://softwaretechnique.jp/OS_Development/Tips/scan_code_set1.html][Tips スキャンコード一覧 スキャンコードセット1 - 0から作るソフトウェア開発]]
- [[http://yanor.net/wiki/?Windows%2FTIPS%2F%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%82%92%E4%BF%AE%E6%AD%A3%E3%81%97%E3%81%A6CAPSLOCK%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6%E5%A4%89%E6%9B%B4][レジストリを修正してCAPSLOCKの割り当て変更 - yanor.net]]

***** Key設定
****** PC
- 内容(2017/12/18)
  00 00 00 00 : header version[4byte]
  00 00 00 00 : flags[4byte]
  04 00 00 00 : エントリ数、terimnate含む
  3A 00 1D 00 : CapsLock で 左Ctrl を上書
  1D 00 3A 00 : 左Ctrl で CapsLock を上書
  79 00 38 E0 : 変換 で 右Alt を上書
  00 00 00 00 : terminate
****** GDP Pocket
- 2017/8/26

**** Link
- [[https://support.microsoft.com/ja-jp/kb/256986][上級ユーザー向けの Windows レジストリ情報 - Microsoft]]
- [[http://www.akadia.com/services/windows_registry_tutorial.html][Windows Registry Tutorial]]

*** Local Security Policy
**** Windows Server 2012 R2
***** Security Settings
****** Account Policies
****** Local Policies
******* Audit Policy
******* User Rights Assighnment
******* Security Options
******** User Account Control: Run all administrators in Admin Approval Mode
****** Windows Firewall with Advanced Security
** Environment Variables
*** Values
**** APPDATA
**** LOCALLAPPDATA
**** OS
**** PATH
**** PATHEXT
- 自動で補完される拡張子の情報
**** ProgramFiles
- %SystemDrive%\Program Files
**** SystemDrive
- ex) C:
**** SystemRoot
- ex)%SystemDrive%\Windows
**** USERPROFILE
- ユーザのプロファイルのパス
  ex) C:\Users\UserName, C:\Dcuments and Settings\UserName
**** windir
- ex)%SystemDrive%\Windows
*** 動的な環境変数
**** %CD%
- 現在のディレクトリ文字列
**** %DATE%
- DATEコマンドと同じフォーマットの現在日付
**** %TIME%
- TIMEコマンドと同じフォーマットの現在時刻
**** %RANDOM%
- 0から32767の間の任意の10進数
**** %ERRORLEVEL%
- 現在のERRORLEVELの値
**** %CMDEXTVERSION%
**** %CMDCMDLINE%
**** %HIGHESTNUMANODENUMbER%
*** Memo
**** Setting 設定
- setを使って、表示や設定を行う
**** Replace 置換
- ex)%PATH:文字列 1 = 文字列2%
  PATH環境変数に含まれるすべての"文字列 1"を"文字列 2"に置き換える。
**** 副文字列の指定
- ex)%PATH:~10,5%
  11番目(オフセット10)の文字から5文字だけを使う。
- ex)%PATH:~-10%
  最後の10文字が展開される
- ex)%PATH:~0,-2%
  最後の2文字以外のすべてが展開される
**** 遅延評価関数
- 実行時に環境変数を展開する。
  変数は感嘆符"!"で囲む。
** Structure
*** Windows(%systemroot%)
**** system
- 16bit時代のsystemファイル。
**** System32
- 32bit OSであれば32bit、64bit OSであれば64bit用のシステムファイル。
***** Boot
***** com
***** CompatTel
***** Dism
***** DriverStore
***** IME
***** migwiz
***** oobe
***** Speech
***** spool
***** sysprep
***** WindowsPowershell
***** wbem
**** SysWOW64
- 64bit OSで32bit OSをエミュレーションする際に利用される、32bit用のシステムファイル。
** Account
*** Service
**** System (Local System)
- NT AUTHORITY\System
- 権限:Administratorsグループメンバと同等
- ネットワークアクセス時の資格情報:ローカルのコンピュータ・アカウント
- Memo:ドメイン参加していないサーバ間では、ネットワーク接続が許可されない可能性がある。
**** Local Service
- NT AUTHORITY\LocalService
- 権限:Usersグループメンバと同等
- ネットワークアクセス時の資格情報:匿名
- Win XPより追加。
**** Network Service
- NT AUTHORITY\NetworkService
- 権限:Usersグループメンバと同等
- ネットワークアクセス時の資格情報:ローカルのコンピュータ・アカウント
- Win XPより追加。
**** Link
- http://www.atmarkit.co.jp/ait/articles/0905/08/news095.html
** Shortcuts
*** Windows 7
**** Win + f : エクスプローラ・"検索結果"を開く
**** Win + Ctrl + f : コンピュータを検索します
**** Win + e : エクスプローラ・"コンピュータ"を開く
**** Ctrl + Shift + Esc : Windowsタスクマネージャー
*** Windows 10
**** Win + Ctrl + d : 仮想デスクトップの作成
**** Win + Ctrl + →(←) : 仮想デスクトップの切り替え
**** Win + Ctrl + F4 : 仮想デスクトップの削除
** License
*** CAL / Client Access License
- Windowsサーバを利用するのに必要なライセンス。
  ユーザーCALとデバイスCALが存在する。
**** Link
- http://www.pg-direct.jp/blog/?p=7718
- http://www.pg-direct.jp/user_data/cal.php
- http://wa3.i-3-i.info/word12578.html
** Glossary
*** WOW64
- Windows 32-bit On Windows 64-bit
  64bit版のWindowsで、Win32アプリケーションを実行する、エミュレーションレイヤー・サブシステム。
  32bitのプログラムはシステムフォルダ(%systemroot%\System32)には直接アクセスできず、
  自動的に%systemroot%\SysWOW64へリダイレクトされる動作となる。配下には32bitのバイナリが用意されている。
  
*** SafeSEH, SoftwareDEP
- http://resemblances.click3.org/?p=1449
*** MMCスナップイン
- Windowsの管理用ツールの中身。
  外側はMicrosoft管理コンソール。「mmc.exe」がMicrosoft管理コンソールの本体。
  スナップインは、たとえば"eventvwr.msc"、"services.msc"など。
*** セキュリティ周り
**** DACL
- Discretionary Access Control List 随意アクセス制御リスト
  リソースに対するアクセスの許可/拒否を制御する。
  ACEが1つ以上格納されているリスト。
**** SACL
- システムアクセス制御リスト
  リソースに対する監査を制御する
**** ACL
**** ACE
- Access Control Entry
**** SDDL
- Security Descriptor Definition Language
  セキュリティ記述子を表現するための汎用的な表記方法。
  DACLだけでなく監査の設定やDCOMのセキュリティ設定などで広く利用される。
***** Description
****** O:UserSID
****** G:GroupSID
****** D:DACLFlag(ACE strings)...
******* DACLFlag
******** P / SE_DACL_PROTECTED
- DACLが継承されたACEによって変更されないように保護する
******** AR / SE_DACL_AUTO_INHERIT_REQ
- DACLを子オブジェクトへ継承するように要求する
******** AI / SE_DACL_AUTO_INHERITED
- 継承によって作成されたDACLであることを示す
****** S:SACLFlag(ACE strings)...
****** ACE strings / ACE文字列
- format:
  (ACL Type;ACE Flag;Rights;Object GUID;Inherit Object GUID; Account SID)
  (ACLタイプ;ACEフラグ;権利;オブジェクトGUID;継承オブジェクトGUID;アカウントSID)
- ex:
  (A;CIOI;GRGWGXSD;;;PU)
- Memo
  - オブジェクトGUIDと継承オブジェクトGUIDはActive DirectoryのオブジェクトのACLのみで使われるもので、通常は空白。
******* ACEタイプ
- ACEの種類を表す
  |--------+---------------------+--------------------------|
  | 文字列 | タイプ名            | 意味                     |
  |--------+---------------------+--------------------------|
  | A      | SDDL_ACCESS_ALLAWED | アクセス許可             |
  | D      |                     | アクセス拒否             |
  | OA     |                     | オブジェクトアクセス許可 |
  | OD     |                     | オブジェクトアクセス拒否 |
  | AU     |                     | 監査                     |
  | AL     |                     | 警告                     |
  | OU     |                     | オブジェクト監査         |
  | OL     |                     | オブジェクト警告         |
  |--------+---------------------+--------------------------|

******* ACEフラグ
- ACEの継承に関する情報を表す
  |--------+----------+------------------|
  | 文字列 | タイプ名 | 意味             |
  |--------+----------+------------------|
  | CI     |          | コンテナ継承     |
  | OI     |          | オブジェクト継承 |
  | NP     |          | 伝播なし         |
  | IO     |          | 継承のみ         |
  | ID     |          | 継承             |
  | SA     |          | 監査成功         |
  | FA     |          | 監査失敗         |
  |--------+----------+------------------|

******* 権利
- Platform SDKに含まれるsddl.hやWinnt.h、APIの解説なども参照のこと
  |--------+----------+------|
  | 文字列 | タイプ名 | 意味 |
  |--------+----------+------|
  |        |          |      |

******* オブジェクトGUID
- パスワードの変更やリセットなど、特別なタスクの実行を許可するための権利を表すオブジェクトのGUID文字列

******* 継承オブジェクトGUID
- ACEを継承するオブジェクトのGUIDを表す文字列

******* アカウントSID
- ACEの提供対象となるSIDを表す。
  |--------+-------------------------|
  | 文字列 | タイプ名                |
  |--------+-------------------------|
  | AO     |                         |
  | AN     |                         |
  | AU     | Authenticated Users     |
  | BA     | Built-in Administrators |
  | BG     |                         |
  | IU     | Interactive             |
  | SU     | Service                 |
  | SY     | Local system            |
  |        |                         |

***** Link
- [[https://msdn.microsoft.com/en-us/library/aa374928.aspx][ACE Strings - Microsoft Developer Network]]
- [[https://support.microsoft.com/ja-jp/help/914392/best-practices-and-guidance-for-writers-of-service-discretionary-acces][サービスの随意アクセス制御リストを作成する場合の推奨事項およびガイド - Microsoftサポート]]
- http://www.atmarkit.co.jp/ait/articles/0603/25/news016.html
*** パス
**** UNC
- Universal Naming Convention
  Windowsネットワーク上で共有されている様々な資源の位置を表記する標準的な記法。
- 「\\コンピュータ名\共有名」のように記述する。
***** Link
- http://e-words.jp/w/UNC.html
- http://desktop.arcgis.com/ja/arcmap/10.3/tools/supplement/pathnames-explained-absolute-relative-unc-and-url.htm#GUID-A2A3F32B-D0AE-4F60-97A9-4DA8AF8DC00B
** Server
*** Roles
**** ADDS Active Directory
- Active Directory Domain Services
***** 2012 R2
- Server Manager : Dashboard -> Add roles and features
  setting...
- Server Manager : AD DS
  setting...
- http://www.rem-system.com/post-671/
*** Features
**** Failover Clustering
- MSCS / Microsoft Clustering Service
- WSFC / Windows Server Failover Cluster (Windows Server 2008以降)
***** Memo
****** Error: A weak event was created ...
- It's a bug, and just run a Windows Update.
  http://www.itprocentral.com/resolving-failover-cluster-error-message-a-weak-event-was-created-and-it-lives-on-the-wrong-object-there-is-a-very-high-chance-this-will-fail-please-review-and-make-changes-onyour-code-to-prevent-t/
***** Link
- [[http://blog.engineer-memo.com/2013/05/08/alwayson-%E3%82%92-azure-%E4%B8%8A%E3%81%AB%E6%A7%8B%E7%AF%89%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B-wsfc-%E3%81%AE%E6%A7%8B%E7%AF%89%E7%B7%A8/][AlwaysOn を Azure 上に構築してみる – WSFC の構築編 – SEの雑記]]
- [[https://msdn.microsoft.com/ja-jp/library/dn505754(v=ws.11).aspx][フェールオーバー クラスターを作成する - Developer Network]]
- [[https://techinfoofmicrosofttech.osscons.jp/index.php?MSCS%2FWSFC][MSCS/WSFC - Open棟梁Project - マイクロソフト系技術情報 Wiki]]

** Tools
*** Chocolatey
- package manager
**** Link
- https://chocolatey.org/packages?q=
- https://qiita.com/msp0310/items/2a92f8966608260c49c1
** Memo
*** ACL
- 
  アクセス制御リスト(Access Control List)。
  あるユーザやグループに対して、利用可能な権限を定義したものを
  アクセス制御エントリ(Access Control Entry : ACE)といい、
  これを集めたものがACLとなる。
  （正確には「随意アクセス制御リスト、Discretionary Access Control List:DACL」らしい。）
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/700whatisacl/whatisacl.html][アクセス制御リストACLとは？ - @IT]]

*** cmdをエクスプローラから開く
- 
  エクスプローラからその場のcmdを開くには、
  アドレスバーにcmdと打つとOK。

*** ローカルユーザで接続する
- 
  .\user、local\user、servername\user等でアクセスできる。

*** システム情報を表示する
- 
  msinfo32。
  スタートからシステム情報も探せるが、プログラム名として打てばよい。
  
*** ローカルのAdminパスワードを変更する方法
- 
  管理者のパスワードを忘れてしまった際、ブートディスクでディスクにアクセスして、
  Utilman.exeを退避し、cmd.exeをcopyして名称をUtilman.exeとすると、
  ログイン画面でコマンドプロンプトが使えるようになる。
  [[http://blogs.technet.com/b/meacoex/archive/2011/08/15/reset-your-windows-sever-2008-r2-domain-controller-administrator-password.aspx][Reset your Windows Server 2008 / R2 Domain Controller administrator password - MEA Center of Expertise]]
  [[http://level69.net/archives/752][Windows Server 2012のパスワードを初期化しよう。- 技術的な何か。]]
  
*** コントロールパネルをコマンドから開く
- [[http://pasofaq.jp/windows/admintools/cpllist7.htm][コントロールパネルのコマンド一覧(Windows 7)]]
*** Thumbs.db
- 
  エクスプローラで縮小表示を行うと、画像や写真データの縮小イメージが格納されたThumbs.dbが作成される。
  必要に応じ再作成されるため、消しても問題ない。またキャッシュしない設定に変更することも出来る。
  [[http://www.atmarkit.co.jp/ait/articles/0602/04/news012.html][Thumbs.dbファイルを作成しないようにする - @IT]]

*** AXキーボード設定
- 
  レジストリを書き換える。
  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\i8042prt\Parametersを選択し、
  以下のように書き換える。
  |----------------------------+-----------+-------------+------------|
  | 値の名称                   | データ値  | 変更前      | 変更後     |
  |----------------------------+-----------+-------------+------------|
  | LayerDriver JPN            | REG_SZ    | kdb101.dll  | kdbax2.dll |
  | OverrideKeyboardIdentifier | REG_SZ    | PCAT_101KEY | AX_105KEY  |
  | OverrideKeyboardSubtype    | REG_DWORD | 0           | 1          |
  | OverrideKeyboardType       | REG_DWORD | 7           | 7          |
  |----------------------------+-----------+-------------+------------|
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/041axkbd/axkbd.html][右Altキーに漢字キーを割り当てる方法 - @IT]]
  
*** スタートアップ等の特殊フォルダーをすばやく開く
- 
  すばやく特殊フォルダを開くには、shell:startup 等のシェルのショートカットを使うとよい。
  [ファイル名を指定して実行]、検索文字列入力欄、エクスプローラアドレスバーなどで指定する。
  コマンドプロンプトから実行するには、先頭に「start」か「explorer」をつける。
  [[http://www.atmarkit.co.jp/ait/articles/1401/24/news036.html][スタートメニューやスタートアップなどの特殊フォルダーの場所を素早く開く - @IT]]

- コマンド
  |-----------------------------------+------------------------------------------------------------|
  | shell:表記                        | フォルダー                                                 |
  |-----------------------------------+------------------------------------------------------------|
  | メニュー                          |                                                            |
  | shell:Start Menu                  | 現在のユーザの[スタート メニュー]                          |
  | shell:Common Start Menu           | 全ユーザ共通の[スタート メニュー]                          |
  | shell:Programs                    | 現在のユーザの[スタート] - [プログラム]                    |
  | shell:Common Programs             | 全ユーザ共通の[スタート] - [プログラム]                    |
  | shell:Startup                     | 現在のユーザの[スタート] - [プログラム] - [スタートアップ] |
  | shell:Common Startup              |                                                            |
  | shell:Administrative Tools        | 現在のユーザの[スタート] - [プログラム] - [管理ツール]     |
  | shell:Common Administrative Tools |                                                            |
  |-----------------------------------+------------------------------------------------------------|
  | ユーザーフォルダ関連              |                                                            |
  | ...                               |                                                            |

*** 環境変数の設定
- 
  よくやるように、コンピュータのプロパティなどからシステム情報に飛び、環境変数を設定すると、
  個別ユーザでなく管理者での登録となる。
  
  コントロールパネルのユーザーアカウントの管理画面左側に、環境変数の設定、という項目があるので、
  個別ユーザでの設定ではそこを選択して設定する。
  
- [[http://note.chiebukuro.yahoo.co.jp/detail/n129063][Windowsで環境変数を設定する - YAHOO!知恵袋]]

*** グラフや絵を文字で作るための変換方法
- 
  ただし全て"けいせん"でも出るけれども。
  
  |------------+------+------|
  | 読み       | 細字 | 太字 |
  |------------+------+------|
  | たて       | │   | ┃   |
  | よこ       | ─   | ━   |
  | たてみぎ   | ├   | ┣   |
  | たてひだり | ┤   | ┫   |
  | よこうえ   | ┴   | ┻   |
  | よこした   | ┬   | ┳   |
  | ひだりうえ | ┌   | ┏   |
  | ひだりした | └   | ┗   |
  | みぎうえ   | ┐   | ┓   |
  | みぎした   | ┘   | ┛   |
  | まんなか   | ┼   | ╋   |
  |------------+------+------|

  [[http://support.microsoft.com/kb/883172/ja][特殊文字・記号や罫線文字の入力一覧]]
  [[http://112123.jugem.jp/?eid=2781][【記号】 文字記号でツリーとか階層を作りたい時の変換方法【豆知識】]]

*** Cドライブの掃除
**** ディスククリーンアップ
- Cのプロパティ->ツールタブ
**** Tempの削除
- C:\WINDOWS\Temp
- C:\Users\(username)\AppData\Local\Temp
- C:\Documents and Settings\(username)\Local Settings\Temp
**** Internet一時ファイルの削除
**** Link
- http://freesoft.tvbok.com/tips/optimise_vista/increase_freespace_c_drive.html
- https://pctrouble.net/running/c_drive_freespace.html
*** システム容量
**** Win7
- [[http://freesoft.tvbok.com/tips/win7rc64/windows7_winsxs.html][Windows7、HDバカ食いの理由 - ぼくんちのTV別館]]
*** Scroll Lock
- 
  矢印キーで画面が動いてしまうのは、スクロールロックがかかっているため。
  キーボードや機種により設定は異なるが、現行は"fn + <(左矢印)"でかかる。

*** IEの設定を取得する
- 
  reg export <レジストリキー> <出力先パス>
  reg export "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" Path

- 
  http://yuzuemon.hatenablog.com/entry/20110510/1305043925

*** レジストリ操作
- 
  http://www.atmarkit.co.jp/ait/articles/0402/21/news005.html

*** System32 / SysWOW64
- System32には64bitプログラム用のファイル（現在使用しているもの）、
  SysWOW64には32bitプログラムを動かすための32bitバイナリが入っている。
  
*** アイコン画像作成
- bmpで保存、拡張子を.icoとすればOK。
*** Bluetooth設定
**** pairing
- [[http://qa.elecom.co.jp/faq_detail.html?id=4406][【Bluetooth】Windows機能でのヘッドセット・ヘッドフォンペアリング方法 - ELECOM]]
**** connection
*** ネットワークドライブの割り当て
- エクスプローラでAlt, 「ネットワークドライブの割り当て」を行う。
- http://www1.ark-info-sys.co.jp/support/all/kakumei/c21.html
*** ドメイン環境で使用されるポート
- https://blogs.technet.microsoft.com/jpntsblog/2009/03/03/563/
**** ドメインメンバー
- 
  |--------------------------+------------+--------------------------+----------------|
  | ポートを使用するサービス | プロトコル | クライアント側ポート番号 | DC側ポート番号 |
  |--------------------------+------------+--------------------------+----------------|
  | PING                     | ICMP       |                         |                |
  | DNS                      | TCP/UDP    | 一時ポート               |             53 |
  | Kerberos                 | TCP/UDP    | 一時ポート               |             88 |
  | NTP                      | UDP        | 123                      |            123 |
  | RPC                      | TCP        | 一時ポート               |            135 |
  | RPC                      | TCP        | 一時ポート               |     一時ポート |
  | NetBIOS-ns               | UDP        | 137                      |            137 |
  | NetBIOS-dgm              | UDP        | 138                      |            138 |
  | NetBIOS-ssn              | TCP        | 一時ポート               |            139 |
  | LDAP                     | TCP/UDP    | 一時ポート               |            389 |
  | SMB                      | TCP        | 一時ポート               |            445 |
  | KPasswd                  | TCP        | 一時ポート               |            464 |
  | LDAP GC                  | TCP        | 一時ポート               |           3268 |
  | LDAP SSL                 | TCP        | 一時ポート               |            636 |
  | LDAP GC SSL              | TCP        | 一時ポート               |           3269 |
  | AD DS Web Services       | TCP        | 一時ポート               |           9389 |
  |--------------------------+------------+--------------------------+----------------|

**** DC間
- 
  |--------------------------+------------+------------------+----------------|
  | ポートを使用するサービス | プロトコル | 送信元ポート番号 | 宛先ポート番号 |
  |--------------------------+------------+------------------+----------------|
  | WINS                     | TCP        | 一時ポート       |             42 |
  | DNS                      | TCP/UDP    | 一時ポート       |             53 |
  | Kerberos                 | TCP/UDP    | 一時ポート       |             88 |
  | NTP                      | UDP        | 123              |            123 |
  | RPC                      | TCP        | 一時ポート       |            135 |
  | RPC                      | TCP        | 一時ポート       |     一時ポート |
  | LDAP                     | TCP/UDP    | 一時ポート       |            389 |
  | SMB                      | TCP        | 一時ポート       |            445 |
  | DFSR                     | TCP        | 一時ポート       |           5722 |
  |--------------------------+------------+------------------+----------------|

*** ハッシュ値を計算する
- certutil -hashfile <filename> <algorithm>
*** サービスに対し権限を設定する
- WindowsのServiceを一般ユーザで操作するには、"sc shshow ServiceName"で確認したSDDIを、
  "sc sdset ServiceName NewSDDI"で書き換えればよい。
  (A;;RPWP;;;AU)とすれば、許可、起動・停止、一般ユーザ、となる。
  [[http://buti.blog.so-net.ne.jp/2010-03-03][【Tips】Windowsのサービスを一般（AdminやPowerGroup以外）ユーザで起動できるようにする。 - Butinekoの世界]]
- scでSDDI形式の
*** リモートデスクトップでパスワード変更
- Ctrl + Alt + End (deleteでなく!)
  http://grum.hatenablog.com/entry/2016/01/13/022550
*** 権限
- everyoneは、ログインできるユーザすべてに対しての権限。
  ユーザ登録していない、ログインできない人も含め全て、の場合はgeustが該当とのこと。
*** シンボリックリンクの設定に関する事項
- [[https://blogs.technet.microsoft.com/jpntsblog/2016/08/31/smbandsymlink/][ファイル共有とシンボリックリンクの利用について - Ask the Network & AD Support Team, Microsoft]]
  アクセス元で"fsutil behavior set symlinkevaluation R2R:1"をしないとRemote間でのリンクは動作しない、など。

- [[http://schinagl.priv.at/nt/hardlinkshellext/hardlinkshellext.html#changesymboliclinkprivilege][Change Symbolic Link Priviledge - Link Shell Extension]]
  シンボリック利用のための権限

*** (聞いた話メモ)
- 
  ntoskrnl.exe
  カーネル本体

- 
  Hardware abstraction の下にBIOSがいる。
  
- 
  Ntdll.dll
  Kernel32.dll
  Win32

- 
  起動プロセス
  smssだけ、カーネル直で読んでる。
  
- 
  Object manager
  セマフォとか、

- 
  カーネルの中のレジストリとか、
  
- 
  Advanced なんとか。
  
- 
  起動プロセス、
  
