* Windows
** Batch
*** Command
**** cls
- 
  画面上の文字を消去する。
  POSIX系shellだとclearかCtr+l。

**** choice

- choice[.exe] [/C <choices>] [/N] [/CS] [/T nnnn [/D c]] [/M <message>]
  - /C <choices>
    選択肢となる文字列を指定する。
  - /N
    選択肢と「？」を表示させない。
  - /CS
    選択肢の大文字小文字を区別する。
  - /T
    選択する時間を設定する。nnnnは制限時間の秒数。
  - /D
    Tで指定した時間が経過した際に選択される選択肢を指定する。
  - /M <message>
    メッセージを表示する。

- 1番目の選択肢を選ぶと1、n番目の選択肢を選ぶとnが終了コード（エラーコード）が返される。
  Ctrl+Cなどが押されると0、エラー時には255が返される。

- ex) choice /C YN /M "続行しますか"
      ⇒続行しますか [Y,N]?

**** cmdkey
- 
  保存されたユーザ名とパスワードの作成、表示、および削除を行う。

- /list{:targetname}
  資格情報を表示する

- /add(/genericも可)
  - /add:targetname /user:username /pass:password
  - /add:targetname /user:username /pass
  - /add:targetname /user:username
  - /add:targetname /smartcard
  
  - /smartcard


- /delete
  - /delete:targetname

  - /delete /ras
    RAS資格情報を削除する
  
**** defined
- 
  環境変数が設定されているかチェックするには、DEFINEDを使う。

- ex) 
    IF DEFINED ENV echo OK

- 
  [[http://orangeclover.hatenablog.com/entry/20110127/1296135692][バッチファイル/コマンドプロンプトで環境変数が設定されているかチェックする方法]]

**** fc
- fc (option) [file1] [file2]
  2つのファイルを比較して相違点を表示する。
- /L
  テキストファイルとして比較する。
- /B
  バイナリファイルとして比較する
- /A
  最初と最後の行のみ表示する
- /LB(行数)
  (行数)以上続いた場合に比較をやめる。

**** cacls
- 
  ファイルやフォルダに対して設定されているACLの内容を確認したり、
  変更するために利用するコマンドラインのツール。

**** help
- 
  コマンドの一覧を取得できる。
  内部コマンドも外部コマンドもあると思われる。

**** setlocal
- 
  バッチファイルでの環境変数のローカル化を開始する。
  以前の設定を復元するにはENDLOCALを実行する。
  バッチスクリプトが終了すると、そのバッチスクリプトで発行されたSETLOCALコマンドに対し、
  暗黙のENDLOCALが実行される。

**** endlocal
- 
  バッチプログラムで一時的に変更した環境変数のローカル化を終了する。

**** robocopy
- 
  フォルダを同期するためのコマンド。
  Robust File Copyの略で、堅牢で確実なファイル・コピーという意味を持つ。
  コマンドラインでなくGUIから使いたい場合は、richcopyが利用できる。

- source dest files (option)
  sourceがコピー元、destがコピー先、filesでコピーするファイルを指定する。
  filesはワイルドカード指定可能で、規定値は*.*。

- /S
  サブディレクトリをコピーするが、空のディレクトリはコピーしない。
  
- /E
  空のサブディレクトリを含むサブディレクトリをコピーする。

- /LEV:n
  コピー元ディレクトリツリーの上位nレベルのみをコピーする。

- /MIR
  2つのフォルダを同期させる。
  destファイルにsourceにないファイルがあれば削除し、古いファイルがあれば上書きされる。
  /purgeと/sを組み合わせた挙動と同じ。

- /COPY:コピーフラグ
  ファイルにコピーする情報
  D:データ、A:属性、T:タイムスタンプ

- /TS
  出力にコピー元ファイルのタイムスタンプを含める

- /FP
  出力にファイルの完全なパス名を含める

- /BYTES
  サイズをバイトで出力する

- /TEE
  コンソールウィンドウとログファイルに出力する

**** ネットワークコマンド
***** arp
- 
  OSが管理しているAPRテーブルを表示したり削除したりするコマンド。
  ARPテーブルは、IPアドレスとMACアドレスを関連付けた一覧。

- -a
  ARPテーブルを表示する

- -d IPアドレス
  指定したIPアドレスのエントリーを削除する

***** getmac
- 
  ネットワークにつながっている別のWindowsのMACアドレスを調べる。
  getmacを使うには管理者権限が必要なので、

- /s target /u username /p password
  サーバ名、管理者のユーザ名、パスワードを指定して、マックアドレスを確認する。

***** hostname
- 
  現在のホスト名を出力する

***** ipconfig
- 
  コンピュータのネットワーク設定情報を表示する

- /all
  すべてのNIC情報を表示する

- /release
  すべてのNICのIPv4のIPアドレスを開放する

- /renew
  すべてのNICのIPv4のIPアドレスを更新する

- /displaydns
  DNSリゾルバのキャッシュを表示する

- /flushdns
  DNSリゾルバのキャッシュをクリアする

***** nbtstat
- 
  Windowsネットワークを管理するためのコマンド。
  NBTとは"NetBIOS over TCP/IP"のこと。

- -c
  キャッシュしている情報を表示する

- -R
  キャッシュ内容をクリアする

- -n
  自分自身の情報を表示する

***** net
- 
  ネットワーク関係の設定を行ったり、現在の状態を表示させたりするために使われるコマンド。
  サブコマンドをいれずに使うとサブコマンド一覧が表示される。
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/258netcommand/netcommand.html][netコマンドの使い方 - @IT]]
  [[http://pasofaq.jp/windows/command/net7.htm][NETコマンド(Windows 7)]]

****** net use
- 
  共有リソースの使用/解除。net shareされたネットワーク上のリソースをローカルで使う場合に使う。

****** net share
- 
  共有リソースの公開/公開停止。ローカルのリソースを公開して、外部のマシンでnet useできるようにする。

****** net view
- 
  リソースが共有されているマシンの列挙や、特定のマシンが公開している共有リソースの一覧を調べる

****** net file
- 
  使用されているファイルの一覧の表示/強制終了。
  net shareで公開されたリソースのうち、どのようなファイルが実際に外部マシンで利用されているか調べる。

****** net session
- 
  ユーザアカウントに対するログオンやパスワードの要件の表示/強制終了

****** net print

****** net user

****** net accounts

****** net group

****** net computer

****** net start
- 
  サービスの表示/開始

****** net stop
- 
  サービスの停止

****** net pause
- 
  サービスの一時停止

****** net continue
- 
  サービスの再開

****** net name
- 
  NetBIOS名の表示・追加。
  新しく追加された名前はnet sendコマンドの宛先として利用できる。

****** net send
- 指定されたユーザやコンピュータに対するメッセージの送信

****** net config
- 
  サーバ・サービスやワークステーション・サービスに関する情報の表示/設定

****** net sattistics
- 
  ネットワーク・プロトコルやリソースの公開/共有サービスに対する統計情報の表示

****** net time
- 
  時間情報の表示や外部との同期

****** net help
- 
  各コマンドの使い方の表示

****** net helpmsg
- 
  エラー番号に対する詳しいエラーメッセージの表示

***** netsh
- 
  netsh（ネットシェル）は、コンピュータのネットワーク設定情報を書き換えるコマンド。
  対話型と結果表示型、どちらも可能。

- ?
  コマンド一覧が表示される

- exit
  終了する

***** netstat
- 
  コンピュータの通信状況を一覧表示する。
  どのコンピュータとどんなプロトコルを使って何番ポートで通信しているかわかる。
  標準設定では、相手のコンピュータはホスト名、プロトコルはウェルノウンポートのプロトコル名で表示される。

- -a
  すべての接続とリッスンポートを表示する
- -n
  実行結果にコンピュータやプロトコル名を使わず、IPアドレスとポート番号で表示する
- -s
  プロトコルごとの統計を表示する。

***** nslookup
- 
  DNSサーバと通信して名前解決の「正引き」や「逆引き」を行うコマンド。
  IPアドレスかドメイン名を入力する。

***** pathping
- 
  ノード間のネットワークの状態を確認する。
  pingとtracertを組み合わせたようなイメージ。

***** ping
- 
  ICMPのサブコマンドechoを使った、単純なパケット通信テストプログラム。
- -t
  中断されるまでホストをpingする
- -n 要求数
  送信するエコー要求数を設定する

***** route
- 
  ルーティングテーブルに関する情報を表示、または変更する。

- -f
  デフォルトゲートウェイを含む全ての静的ルーティング情報を消去する。

- add|change|delete 宛先アドレス [mask ネットマスク] ゲートウェイ
  指定したルーティング情報を追加、変更、消去する。

- print
  ルーティング情報を表示する。

***** telnet
- 
  ネットワーク越しに別のコンピュータを操作するコマンド。
  Vista以降はコントロールパネルで有効化する必要がある。
  平文で送信されるので、使う範囲はLAN内に限定するべき。

***** tracert
- 
  実行するコンピュータから通信相手までの経路上にあるルータを一覧表示するコマンド。
  pingと同様ICMPのエコー要求・応答を利用している。
  TTLが1からスタートし、1つずつ大きくして経路上のルータを一覧表示する機能。

***** 外部link

- [[http://itpro.nikkeibp.co.jp/article/COLUMN/20060224/230618/][管理者必見！ネットワーク・コマンド集]]
- [[http://itpro.nikkeibp.co.jp/article/COLUMN/20131219/525889/][最重要ネットコマンド10]]
- [[http://blog.asial.co.jp/1157][使えると便利なWindowsネットワークコマンド]]

*** Tool

**** systeminfo
- 
  システム情報を表示できる。cmd上でsysteminfo。
  デフォルトではローカルコンピュータ。
  ただし/s servername, /u UserName, /p Passwordなどを入力すると、
  リモートの情報も取得できる。

**** WMI (Windows Management Instrumentation)
- 
  システム管理用インターフェイス。
  WBEMというシステム管理を目的とした標準仕様に従って、WinOSに実装、拡張したもの。
  wmicというCommandLineツールを使って情報を取得したり操作できる。
  "wmic qfe"として適用済みのKBを取得できる。

**** ユーザアカウント
- 
  newplwiz.exeで開く。
  パスワード忘れてCMD立ち上げたときとかに役立つ。

*** etc

**** IF文の複数条件指定
- 

  ANDやORに相当する機能はない。ただし、AND条件であればIF文を並べて記述できる。
  ex:) IF %A% == 1 IF %B% == 2 (
         REM 1かつ2のAND条件
     ) ELSE (
         それ以外
     )
- 
  [[http://capm-network.com/?tag=Windows%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%88%B6%E5%BE%A1%E6%A7%8B%E6%96%87][CapmNetwork Windowsバッチファイル制御構文]]


**** 処理の途中で改行を入れる
- 
  バッチファイルでのエスケープシーケンスは「^(hat)」なので、
  改行前に^をおくと複数行を1行として扱える。
  ex:) IF %ABCDEFGHIJKLM% ==1 ^
       IF %NOPQRSTUVWXYZ% ==2 (
         REM 処理
     )
- [[http://orangeclover.hatenablog.com/entry/20100810/1281450669][みちしるべ バッチファイルで長い1行の処理を改行を入れて複数行に分けて書きたい]]
- [[http://pf-j.sakura.ne.jp/program/dos/doscmd/str_circumflex.htm][ProgrammingField DOSコマンド一覧 ^(ハット記号)]]


**** 環境変数の消し方
- 
  "SET 変数="とする。
  たとえば変数XYZを初期化したければ、"set XYZ="でよい。

- [[http://orangeclover.hatenablog.com/entry/20090826/1251293551][みちしるべ 3.環境変数 (1)環境変数の使い方 〜意外に削除の仕方はしらない人が多い〜 【コマンドプロンプト、バッチファイルを使わなきゃならなくなった人向けのメモ】]]


**** バッチでの標準入力待ち
- 
  "SET /P 変数=出力文字列"、という感じの構文。
  たとえば"set /P var=好きな英数字を入力してください。"とすると、
  "好きな英数字を入力してください。"と画面に出力された後入力待ちになり、
  改行するまでの文字列がvarに格納される。
  バッチファイルでユーザーに入力させた値を取得する

** Files
*** pagefile.sys
- C:\pagefile.sys
  paging file.
- [[http://lifehacker.com/5426041/understanding-the-windows-pagefile-and-why-you-shouldnt-disable-it][Understanding the Windows Pagefile and Why You Shouldn't Disable It - lifehacker]]

*** hiberfil.sys
- C:\hiberfil.sys
  when hybernation is start, data on memory is moved this file.
** Settings
*** Control Panel
**** Win7
***** ユーザーアカウント
****** 資格情報の管理
******* 汎用資格情報
- 
  [[http://news.mynavi.jp/special/2009/windows7/081.html][第6章 Windows 7のセキュリティとメンテナンス - パスワードを一括管理する「資格情報マネージャー」 - マイナビ ニュース]]

- command
  cmdkey (/list, /add)
  [[http://blog.putise.com/windows%E3%81%AE%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E8%B3%87%E6%A0%BC%E6%83%85%E5%A0%B1%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E5%90%8D%E3%83%BB%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC/][Windowsのネットワーク資格情報(ユーザー名・パスワード)を記憶させる方法。コマンドもある - puti se blog]]

***** フォント
- フォントをここに置くと適用される。
*** Registry
** DOS
*** DOSエクステンダー
*** DPMI
** memo
*** ACL
- 
  アクセス制御リスト(Access Control List)。
  あるユーザやグループに対して、利用可能な権限を定義したものを
  アクセス制御エントリ(Access Control Entry : ACE)といい、
  これを集めたものがACLとなる。
  （正確には「随意アクセス制御リスト、Discretionary Access Control List:DACL」らしい。）
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/700whatisacl/whatisacl.html][アクセス制御リストACLとは？ - @IT]]

*** cmdをエクスプローラから開く
- 
  エクスプローラからその場のcmdを開くには、
  アドレスバーにcmdと打つとOK。

*** ローカルユーザで接続する
- 
  .\user、local\user、servername\user等でアクセスできる。

*** システム情報を表示する
- 
  msinfo32。
  スタートからシステム情報も探せるが、プログラム名として打てばよい。
  
*** ローカルのAdminパスワードを変更する方法
- 
  管理者のパスワードを忘れてしまった際、ブートディスクでディスクにアクセスして、
  Utilman.exeを退避し、cmd.exeをcopyして名称をUtilman.exeとすると、
  ログイン画面でコマンドプロンプトが使えるようになる。
  [[http://blogs.technet.com/b/meacoex/archive/2011/08/15/reset-your-windows-sever-2008-r2-domain-controller-administrator-password.aspx][Reset your Windows Server 2008 / R2 Domain Controller administrator password - MEA Center of Expertise]]
  [[http://level69.net/archives/752][Windows Server 2012のパスワードを初期化しよう。- 技術的な何か。]]
  
*** Thumbs.db
- 
  エクスプローラで縮小表示を行うと、画像や写真データの縮小イメージが格納されたThumbs.dbが作成される。
  必要に応じ再作成されるため、消しても問題ない。またキャッシュしない設定に変更することも出来る。
  [[http://www.atmarkit.co.jp/ait/articles/0602/04/news012.html][Thumbs.dbファイルを作成しないようにする - @IT]]

*** AXキーボード設定
- 
  レジストリを書き換える。
  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\i8042prt\Parametersを選択し、
  以下のように書き換える。
  |----------------------------+-----------+-------------+------------|
  | 値の名称                   | データ値  | 変更前      | 変更後     |
  |----------------------------+-----------+-------------+------------|
  | LayerDriver JPN            | REG_SZ    | kdb101.dll  | kdbax2.dll |
  | OverrideKeyboardIdentifier | REG_SZ    | PCAT_101KEY | AX_105KEY  |
  | OverrideKeyboardSubtype    | REG_DWORD | 0           | 1          |
  | OverrideKeyboardType       | REG_DWORD | 7           | 7          |
  |----------------------------+-----------+-------------+------------|
  [[http://www.atmarkit.co.jp/fwin2k/win2ktips/041axkbd/axkbd.html][右Altキーに漢字キーを割り当てる方法 - @IT]]
  
*** スタートアップ等の特殊フォルダーをすばやく開く
- 
  すばやく特殊フォルダを開くには、shell:startup 等のシェルのショートカットを使うとよい。
  [ファイル名を指定して実行]、検索文字列入力欄、エクスプローラアドレスバーなどで指定する。
  コマンドプロンプトから実行するには、先頭に「start」か「explorer」をつける。
  [[http://www.atmarkit.co.jp/ait/articles/1401/24/news036.html][スタートメニューやスタートアップなどの特殊フォルダーの場所を素早く開く - @IT]]

- コマンド
  |-----------------------------------+------------------------------------------------------------|
  | shell:表記                        | フォルダー                                                 |
  |-----------------------------------+------------------------------------------------------------|
  | メニュー                          |                                                            |
  | shell:Start Menu                  | 現在のユーザの[スタート メニュー]                          |
  | shell:Common Start Menu           | 全ユーザ共通の[スタート メニュー]                          |
  | shell:Programs                    | 現在のユーザの[スタート] - [プログラム]                    |
  | shell:Common Programs             | 全ユーザ共通の[スタート] - [プログラム]                    |
  | shell:Startup                     | 現在のユーザの[スタート] - [プログラム] - [スタートアップ] |
  | shell:Common Startup              |                                                            |
  | shell:Administrative Tools        | 現在のユーザの[スタート] - [プログラム] - [管理ツール]     |
  | shell:Common Administrative Tools |                                                            |
  |-----------------------------------+------------------------------------------------------------|
  | ユーザーフォルダ関連              |                                                            |
  | ...                               |                                                            |

*** 環境変数の設定
- 
  よくやるように、コンピュータのプロパティなどからシステム情報に飛び、環境変数を設定すると、
  個別ユーザでなく管理者での登録となる。
  
  コントロールパネルのユーザーアカウントの管理画面左側に、環境変数の設定、という項目があるので、
  個別ユーザでの設定ではそこを選択して設定する。
  
- [[http://note.chiebukuro.yahoo.co.jp/detail/n129063][Windowsで環境変数を設定する - YAHOO!知恵袋]]

*** グラフや絵を文字で作るための変換方法
- 
  ただし全て"けいせん"でも出るけれども。
  
  |------------+------+------|
  | 読み       | 細字 | 太字 |
  |------------+------+------|
  | たて       | │   | ┃   |
  | よこ       | ─   | ━   |
  | たてみぎ   | ├   | ┣   |
  | たてひだり | ┤   | ┫   |
  | よこうえ   | ┴   | ┻   |
  | よこした   | ┬   | ┳   |
  | ひだりうえ | ┌   | ┏   |
  | ひだりした | └   | ┗   |
  | みぎうえ   | ┐   | ┓   |
  | みぎした   | ┘   | ┛   |
  | まんなか   | ┼   | ╋   |
  |------------+------+------|

  [[http://support.microsoft.com/kb/883172/ja][特殊文字・記号や罫線文字の入力一覧]]
  [[http://112123.jugem.jp/?eid=2781][【記号】 文字記号でツリーとか階層を作りたい時の変換方法【豆知識】]]

*** Win7システム容量
- [[http://freesoft.tvbok.com/tips/win7rc64/windows7_winsxs.html][Windows7、HDバカ食いの理由 - ぼくんちのTV別館]]

*** Scroll Lock
- 
  矢印キーで画面が動いてしまうのは、スクロールロックがかかっているため。
  キーボードや機種により設定は異なるが、現行は"fn + <(左矢印)"でかかる。

*** IEの設定を取得する
- 
  reg export <レジストリキー> <出力先パス>
  reg export "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" Path

- 
  http://yuzuemon.hatenablog.com/entry/20110510/1305043925

*** レジストリ操作
- 
  http://www.atmarkit.co.jp/ait/articles/0402/21/news005.html

*** (聞いた話メモ)
- 
  
- 
  ntoskrnl.exe
  カーネル本体

- 
  Hardware abstraction の下にBIOSがいる。
  

- 
  Ntdll.dll
  Kernel32.dll
  Win32


- 
  起動プロセス
  smssだけ、カーネル直で読んでる。
  
- 
  Object manager
  セマフォとか、

- 
  カーネルの中のレジストリとか、
  
- 
  Advanced なんとか。
  
- 
  起動プロセス、
  
