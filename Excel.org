* Excel
** Functions 関数
*** 互換性関数
- より精度が高く、適切な名前を持つ新しい関数に置き換えられている。
**** (obsolete)FLOOR
*** キューブ関数
*** データベース関数
*** 日付と時刻の関数
**** DATE
- 
  =DATE(年,月,日)
**** DATEDIF
- 
  2つの日付間の日数、月数、年数を計算する。
  Lotus 1-2-3との互換性を維持するために用意されている。
- Format
  DATEDIF(開始日,終了日,単位)
  - 単位 : "Y","M","D","MD","YM","YD"
- 例
  =DATEDIF(2001/01/01,2003/01/01,"D")

**** DATEVALUE
**** DAY
**** DAYS
**** HOUR
**** MINUTE
**** MONTH
**** NOW
**** SECOND
**** TIME
**** TODAY
**** WEEKDAY
- 
  与えられたシリアル値(日付)に対し、何曜日を表しているかを表す数字を返す。
  =weekday(シリアル値,種類)
  
- 返り値の種類
  |--------------------+------------------|
  |        2つ目の引数 | 値と曜日の関係   |
  |--------------------+------------------|
  | 1 又は省略した場合 | 1(日曜)～7(土曜) |
  |                  2 | 1(月曜)～7(日曜) |
  |                  3 | 0(月曜)～6(日曜) |
  |--------------------+------------------|

**** WORKDAY
- 
  開始日から起算して、指定された稼働日数だけ前または後の日付に対応する値を返す。

- 書式
  WORKDAY(開始日, 日数, [祝日])

**** YEAR
*** エンジニアリング関数
*** 財務関数
*** 情報関数
**** CELL
**** INFO
**** ISBLANK
- 対象が空白セルを参照するときにTRUEを返す
**** ISERR
- 対象が#N/A以外のエラー値の時にTRUEを返す
**** ISERROR
- 対象が任意のエラー値の時にTRUEを返す
**** ISEVEN
**** ISFORMULA
**** N
- 値を数値に変換する
**** NA
- 書式
  NA()
- 
  セルの値をエラー値「#N/A」とする。

**** TYPE
- データ型を表す数値を返す。
*** 論理関数
**** AND
**** FALSE
**** IF
- 
  
**** IFERROR
**** IFNA
**** IFS
**** NOT
**** OR
**** SWITCH
**** TRUE
**** XOR
- 
  排他的論理和を計算する。
*** 検索/行列関数
**** ADDRESS
**** AREAS
**** CHOOSE
- 
  一つ目の引数に入力された数値に応じて、第二引数以降のいずれかを返り値として返す関数。
  =choose(条件となる数値,値1,値2,...)
  条件となる数値が1の場合値1、2の場合値2、...が返る。
  29以下までしか定義できない。
**** COLUMN
**** COLUMNS
**** FORMULATEXT
**** GETPIVOTDATA
**** HLOOPUP
**** HYPERLINK
**** INDEX
- INDEX(array,row_num,[column_num])
- INDEX(reference,row_num,[column_num],[area_num])
**** INDIRECT
- INDIRECT(参照文字列,[参照形式])
- 指定される文字列への参照を返す。
**** LOOKUP
**** MATCH
- 
**** OFFSET
**** ROW
**** ROWS
**** RTD
**** TRANSPOSE
**** VLOOKUP
- VLOOKUP(検索値,範囲,列番号[,検索方法])
  
- 検索方法
  FALSE, 0と入力すると、完全一致するデータのみを探す。
  TRUE, 1, 省略した場合は検索地未満の最大値が返される。（昇順に並んでいない場合適切に帰らない）
*** 数学/三角関数
**** CEILING
**** CEILING.MATH
- 指定された基準値の倍数のうち、最も近い値に数値を切り上げる。
**** FLOOR.MATH
- 指定された基準値の倍数のうち、最も近い値に数値を切り捨てる。
**** MOD
- 数値を除算したときの剰余を返す
**** POWER
- 数値のべき乗を返す
**** ROUND
- 数値を四捨五入して指定された桁数にする
**** ROUNDDOWN
- 指定された桁数で切り捨てる
**** ROUNDUP
- 指定された桁数で切り上げる
**** SUM
*** 統計関数
**** COUNT
- COUNT(範囲)
  数値データのセルを数える
**** COUNTA
- COUNTA(範囲)
  未入力セル以外を数える。
**** COUNTBLANK
- COUNTBLANK(範囲)
  空白のセルを数える
**** COUNTIF
- COUNTIF(範囲,検索条件)
  検索条件に合うセルを数える。
**** COUNTIFS
- COUNTIF(範囲1,検索条件1,範囲2,検索条件2,...)
  複数条件を設定してcountを行うことができる。
*** 文字列関数
**** CHAR
- CHAR(数値)
- 数値で指定された文字を返す。
- ex
  =CHAR(65) ⇒ A
  =CHAR(33) ⇒ !
**** CODE
- CODE(文字列)
- テキスト文字列内の先頭文字の数値コードを返す。
- ex
  =CODE("A") ⇒ 65
  =CODE("!") ⇒ 33
**** EXACT
- 
  2つのテキスト文字列を比較し、同じであればTRUE、それ以外の場合はFALSEを返す。

- ex
  EXACT(text1, text2)

**** FIND, FINDB
- FIND(検索文字列, 対象, [開始位置])
  指定された文字列を他の文字列の中で検索し、最初に現れる位置を左端から数え、その番号を返す。
  FIND関数は1バイト文字セットを使う言語での使用を意図したもので、FINDB関数は2バイト文字セットを使う言語での使用を前提としている。
  - FIND関数では、規定言語の設定に関係なく、1バイト文字も2バイト文字も、各文字が常に1つとして数えられる。
  - FINDB関数では、DBCSをサポートする言語のへ週を有効にした後でその言語を規定の言語として設定した場合に、各2バイト文字が2つとして数えられる。
    それ以外の場合は各文字は1つとして数えられる。

- 例
  =LEFT(A1,FIND("(",A1)-1)

**** LEFT, LEFTB
- 先頭から指定された文字数の文字を返す
**** LEN, LENB
- 
  セルの文字数を数える。
  [[https://support.office.com/ja-jp/article/%E3%82%BB%E3%83%AB%E5%86%85%E3%81%AE%E6%96%87%E5%AD%97%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%82%8B-1be151d7-5b8f-4186-87b9-7b0318583163][セル内の文字数を数える - Office]]

**** LOWER
- LOWER(文字列)
  文字を小文字に変換する
**** MID, MIDB
- 書式
  MID(文字列、開始位置、文字数）

- 
  "文字列"の"開始位置"から"文字数"分だけ文字を取得する。

**** PROPER
- PROPER(文字列)
  先頭の文字、および記号の次の文字を大文字に変換、その他を小文字とする。
**** REPLACE, REPLACEB
**** RIGHT, RIGHTB
**** SEARCH, SEARCHB
**** SUBSTITUTE
- 書式
  SUBSTITUTE(対象文字列、検索文字、置き換え文字、[置換対象])

- 
  "対象文字列"中の"検索文字"を"置き換え文字"に変換する。
  "置換対象"は、複数の検索文字がヒットする場合、左から何番目を置き換えるか指定する。

**** T
- 引数を文字列に変換する
**** TEXT
- TEXT(書式設定する値, "適用する表示形式いコード")
  数値を書式設定した文字列に変換する
***** 表示形式
- https://dekiru.net/article/4509/
**** TRIM
- 文字列から余分なスペースを削除する
**** UPPER
- UPPER(文字列)
  文字を大文字に変換する
**** VALUE
- 文字列を数値に変換する
*** アドインでインストールされるユーザー定義関数
*** Web関数
*** Link
- [[https://support.office.com/ja-jp/article/Excel-%E9%96%A2%E6%95%B0-%E3%82%A2%E3%83%AB%E3%83%95%E3%82%A1%E3%83%99%E3%83%83%E3%83%88%E9%A0%86-b3944572-255d-4efb-bb96-c6d90033e188][Excel関数（アルファベット順） - Office]]
- [[https://support.office.com/ja-jp/article/Excel-%E9%96%A2%E6%95%B0-%E6%A9%9F%E8%83%BD%E5%88%A5-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb][Excel関数（機能別） - Office]]
** Shortcuts ショートカット
*** Frequently used
**** 指定セルへジャンプ(Ctrl+G)
- 
  Ctrl+Gでジャンプ用のサブウィンドウが開く。
  "E25"とか指定するとジャンプできる。

**** 上のセルコピペ(Ctrl+D)
- Ctrl+Dで上のセルを下方向へコピー。
**** 左のセルコピぺ(Ctrl+R)
- Ctrl+Rで左のセルを右方向へコピー。
**** 最後のコマンド・操作を繰り返す(Ctrl+Y)
**** 行列、セルの挿入(Ctrl+"+")
**** 行列、セルの削除(Ctrl+"-")
- セルを削除
**** 右クリックメニューを出す(Shift+F10)

**** フィルタのつけ外し(Ctrl+Shift-L)
*** Ribbon
**** 値貼り付け(Alt,E,S,V)
- 
  値貼り付けを行う。
  Alt,E,Sで特別な方法で貼り付け。Vで方法としてValueを選択してくれる。

**** フォーマット貼り付け(Alt,E,S,T)
**** オートフィル(Alt,E,I,S)
- 
  オートフィル。連番を振れる。

**** オートフィルタ設定(Alt,D,F,F)

**** オートフィルタ設定解除(Alt,D,F,S)
**** ワークシート名の変更(Alt,O,H,R)
*** Link
- [[https://support.office.com/en-us/article/Excel-keyboard-shortcuts-and-function-keys-1798d9d5-842a-42b8-9c99-9b7213f0040f][Excel keyboard shortcuts and function keys - Office]]
- [[https://support.office.com/ja-jp/article/Excel-%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89-%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%88%E3%82%AB%E3%83%83%E3%83%88-%E3%83%95%E3%82%A1%E3%83%B3%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3-%E3%82%AD%E3%83%BC-1798d9d5-842a-42b8-9c99-9b7213f0040f][Excel キーボード ショートカット - ファンクション キー - Office]]

- [[http://matome.naver.jp/odai/2134702837577488501][Excelで役立つ10のショートカットキー]]
- [[http://excel-hack.com/beginner/shortcutkey-list/][覚えると便利！124個のExcelショートカットキー一覧表 - Excel Hack]]
- [[https://liginc.co.jp/life/useful-info/162348][エクセル（Excel）の便利なショートカットキーまとめ - LIG INC.]]

- [[https://exceljet.net/keyboard-shortcuts][222 Excel keyboard shortcuts for PC and Mac - EXCELJET]]
- [[https://exceljet.net/the-54-excel-shortcuts-you-really-should-know][The 54 Excel shortcuts you really should know - EXCELJET]]

** データベース機能
*** テーブル
- 変換
  挿入/INSERTタブのテーブルを選択する。

- 利点
  - 自動的に1行おきの色違いになる
  - 自動的にフィルタが有効となる
  - 集計行を簡単に追加可能
  - スクロールしても先頭行が見える
  - 上記をDESIGNタブで制御できる

*** ピボットテーブル
- 
  「クロス集計」を行う機能。
  
** VBA
- [[file:./VBA.org][VBA.org]]
** Memo
*** シート名を取得する
- 
  =RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1)))

*** 曜日を表示する
- 
  セルの書式設定でフォーマットで、aaa, aaaa, ddd, dddd等で曜日の表示が可能。
  また、他セルの場合chooseとweekdayの組み合わせで曜日を表示することなども可能。
  ex) =choose(weekday(A1),"日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日")
      =text(A1,"aaaa")

*** 複数のセル選択後、選択解除
- 
  Tabキーで選択場所を移し、Shift+↑/↓を操作することで、
  選択範囲の拡大/縮小を行うことができる。
  それにより一度選択した範囲を外すことができる。
  [[http://oshiete.goo.ne.jp/qa/256213.html][エクセルで複数のセル選択をした後、選択したセルの１つを選択解除したい - 教えて!goo]]
  
*** シートのコピー
- 
  Ctrlを押しながら、シートをドラッグするとコピーができる。
  [[http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1443247924][エクセルで作成したシートのコピーを一度に複数作る - yahoo!知恵袋]]

*** 各種特殊文字の置換
- 改行コード
  Ctrl+J

*** グループ化
- 
  Dataタブの配下に、グループ化の設定ができる。
  [Alt]+[Shift]+[→]でグループ化、[Alt]+[Shift]+[←]でグループ解除ができる。

*** スクロールロック
- 
  カーソルキーで画面がスクロールしてしまう場合は、Scroll Lockとなっている。

*** 数式を使って数字として扱う方法
- 
  =数式*1とすると、文字列が数字に変換される。
  [[https://love-guava.com/excel-string-numerical-value-change/][Excel（エクセル）で文字列と数値を変換する方法。知っとくと地味に便利ですよ！ - ラブグアバ]]
*** 再計算を自動で行わない
- 
  数式->計算方法の設定->手動、を選択。
  Select FORMULAS->Calculation Options->Manual
  [[http://ameblo.jp/sugoikaizen/entry-12031805139.html][Excelがいちいち再計算で止まってしまう現象を止める方法 - エクセルセミナー研修のすごい改善～Excel社員研修と業務効率化]]

*** 高速vlookup
- 
  大体以下のような感じ。
  =IF(INDEX(Sheet1!$A$2:$A$200001,MATCH($A2,Sheet1!$A$2:$A$200001,1),1)=$A2,VLOOKUP($A2,Sheet1!$A$2:$B$200001,2,TRUE),NA())
  INDEX,MATCHをTRUEで近似値で行い、それが元値と一致した場合のみvlookupで近似値計算。
  近似値計算の方が早いため。ただし対象を昇順に並べておく必要あり。
  別にINDEX, MATCHを二回やってもよいと思われる。

  [[http://excel-ubara.com/excel3/EXCEL019.html][【奥義】大量データでの高速VLOOKUP - エクセルの神髄]]

*** シート名の変更
- ショートカット : Alt,O,H,R
- シートをダブルクリック
*** ワークシートの再表示(unhide)
- 
  基本的に大したショートカットもない。
  Alt->H->O->U->Hでメニューバーをたどることはできる。
  （Home, Format, Hide & Unhide, Unhide sheet)

- 一括再表示
  VBAを使う。
  - 例)
    For Each Sh In ActiveWorkbook.Sheets
        Sh.Visible = True
    Next Sh
*** セルの参照を文字列で作成
- INDIRECT関数を使う。
  =INDIRECT(A4&"!B3")などとして使う。
  A4にあるシート名の、B3セルの参照が取得できる。
*** 日時のシリアル値
- Excelでは、時刻・時間をシリアル値という値で処理する。
  1日(24h)を1.0で表し、0:00:00-23:59:59までが0~0.99999999の範囲の値となる。
- 1900年1月1日からの経過日数を表す。
- http://www.excel.studio-kazu.jp/tips/0049/
*** 日付表示
**** 24h以上の日付を表示する場合
- [h]を使う。[h]:mm:ssなど。
** Link
- [[https://www.youtube.com/watch?v=0nbkaYsR94c][You Suck at Excel with Joel Spolsky - YouTube]]
- [[https://www.maxmasnick.com/2015/09/15/excel/][Notes from "You Suck at Excel" with Joel Spolsky - MAX MASNICK, PhD]]
