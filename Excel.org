* Excel
** 関数
- 
  [[http://dekiru.net/article/4429/][Excel関数一覧 機能別 - できるネット]]

*** CHOOSE
- 
  一つ目の引数に入力された数値に応じて、第二引数以降のいずれかを返り値として返す関数。
  =choose(条件となる数値,値1,値2,...)
  条件となる数値が1の場合値1、2の場合値2、...が返る。
  29以下までしか定義できない。

*** COUNT
- COUNT(範囲)
  数値データのセルを数える
*** COUNTA
- COUNTA(範囲)
  未入力セル以外を数える。
*** COUNTBLANK
- COUNTBLANK(範囲)
  空白のセルを数える
*** COUNTIF
- COUNTIF(範囲,検索条件)
  検索条件に合うセルを数える。
*** COUNTIFS
- COUNTIF(範囲1,検索条件1,範囲2,検索条件2,...)
  複数条件を設定してcountを行うことができる。
*** EXACT
- 
  2つのテキスト文字列を比較し、同じであればTRUE、それ以外の場合はFALSEを返す。

- ex
  EXACT(text1, text2)

*** FIND
- FIND(検索文字列, 対象, [開始位置])
  指定された文字列を他の文字列の中で検索し、最初に現れる位置を左端から数え、その番号を返す。
  FIND関数は1バイト文字セットを使う言語での使用を意図したもので、FINDB関数は2バイト文字セットを使う言語での使用を前提としている。
  - FIND関数では、規定言語の設定に関係なく、1バイト文字も2バイト文字も、各文字が常に1つとして数えられる。
  - FINDB関数では、DBCSをサポートする言語のへ週を有効にした後でその言語を規定の言語として設定した場合に、各2バイト文字が2つとして数えられる。
    それ以外の場合は各文字は1つとして数えられる。

- 例
  =LEFT(A1,FIND("(",A1)-1)

*** IF
- 
  
*** INDEX
- INDEX(array,row_num,[column_num])
- INDEX(reference,row_num,[column_num],[area_num])

*** LEN
- 
  セルの文字数を数える。
  [[https://support.office.com/ja-jp/article/%E3%82%BB%E3%83%AB%E5%86%85%E3%81%AE%E6%96%87%E5%AD%97%E6%95%B0%E3%82%92%E6%95%B0%E3%81%88%E3%82%8B-1be151d7-5b8f-4186-87b9-7b0318583163][セル内の文字数を数える - Office]]

*** LOWER
- LOWER(文字列)
  文字を小文字に変換する
*** MATCH
- 
*** MID
- 書式
  MID(文字列、開始位置、文字数）

- 
  "文字列"の"開始位置"から"文字数"分だけ文字を取得する。

*** NA
- 書式
  NA()
- 
  セルの値をエラー値「#N/A」とする。

*** PROPER
- PROPER(文字列)
  先頭の文字、および記号の次の文字を大文字に変換、その他を小文字とする。
*** SUBSTITUTE
- 書式
  SUBSTITUTE(対象文字列、検索文字、置き換え文字、[置換対象])

- 
  "対象文字列"中の"検索文字"を"置き換え文字"に変換する。
  "置換対象"は、複数の検索文字がヒットする場合、左から何番目を置き換えるか指定する。

*** SUM
*** UPPER
- UPPER(文字列)
  文字を大文字に変換する
*** VLOOKUP
- VLOOKUP(検索値,範囲,列番号[,検索方法])
  
- 検索方法
  FALSE, 0と入力すると、完全一致するデータのみを探す。
  TRUE, 1, 省略した場合は検索地未満の最大値が返される。（昇順に並んでいない場合適切に帰らない）
*** WEEKDAY
- 
  与えられたシリアル値(日付)に対し、何曜日を表しているかを表す数字を返す。
  =weekday(シリアル値,種類)
  
- 返り値の種類
  |--------------------+------------------|
  |        2つ目の引数 | 値と曜日の関係   |
  |--------------------+------------------|
  | 1 又は省略した場合 | 1(日曜)～7(土曜) |
  |                  2 | 1(月曜)～7(日曜) |
  |                  3 | 0(月曜)～6(日曜) |
  |--------------------+------------------|

*** XOR
- 
  排他的論理和を計算する。
** ショートカット
*** 指定セルへジャンプ(Ctrl+G)
- 
  Ctrl+Gでジャンプ用のサブウィンドウが開く。
  "E25"とか指定するとジャンプできる。

*** 上のセルコピペ(Ctrl+D)
- 
  Ctrl+Dで上のセルをコピー。

*** 左のセルコピぺ(Ctrl+R)
- 
  Ctrl+Rで左のセルをコピー。

*** 値貼り付け(Alt,E,S,V)
- 
  値貼り付けを行う。
  Alt,E,Sで特別な方法で貼り付け。Vで方法としてValueを選択してくれる。

*** フォーマット貼り付け(Alt,E,S,T)
*** オートフィル(Alt,E,I,S)
- 
  オートフィル。連番を振れる。

*** オートフィルタ設定(Alt,D,F,F)

*** オートフィルタ設定解除(Alt,D,F,S)
*** 右クリックメニューを出す(Shift+F10)
*** ワークシート名の変更(Alt,O,H,R)
*** Link
- [[http://matome.naver.jp/odai/2134702837577488501][Excelで役立つ10のショートカットキー]]

** データベース機能
*** テーブル
- 変換
  挿入/INSERTタブのテーブルを選択する。

- 利点
  - 自動的に1行おきの色違いになる
  - 自動的にフィルタが有効となる
  - 集計行を簡単に追加可能
  - スクロールしても先頭行が見える
  - 上記をDESIGNタブで制御できる

*** ピボットテーブル
- 
  「クロス集計」を行う機能。
  
** memo
*** シート名を取得する
- 
  =RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1)))

*** 曜日を表示する
- 
  セルの書式設定でフォーマットで、aaa, aaaa, ddd, dddd等で曜日の表示が可能。
  また、他セルの場合chooseとweekdayの組み合わせで曜日を表示することなども可能。
  ex) =choose(weekday(A1),"日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日")
      =text(A1,"aaaa")

*** 複数のセル選択後、選択解除
- 
  Tabキーで選択場所を移し、Shift+↑/↓を操作することで、
  選択範囲の拡大/縮小を行うことができる。
  それにより一度選択した範囲を外すことができる。
  [[http://oshiete.goo.ne.jp/qa/256213.html][エクセルで複数のセル選択をした後、選択したセルの１つを選択解除したい - 教えて!goo]]
  
*** シートのコピー
- 
  Ctrlを押しながら、シートをドラッグするとコピーができる。
  [[http://detail.chiebukuro.yahoo.co.jp/qa/question_detail/q1443247924][エクセルで作成したシートのコピーを一度に複数作る - yahoo!知恵袋]]

*** 各種特殊文字の置換
- 改行コード
  Ctrl+J

*** グループ化
- 
  Dataタブの配下に、グループ化の設定ができる。
  [Alt]+[Shift]+[→]でグループ化、[Alt]+[Shift]+[←]でグループ解除ができる。

*** スクロールロック
- 
  カーソルキーで画面がスクロールしてしまう場合は、Scroll Lockとなっている。

*** 数式を使って数字として扱う方法
- 
  =数式*1とすると、文字列が数字に変換される。
  [[https://love-guava.com/excel-string-numerical-value-change/][Excel（エクセル）で文字列と数値を変換する方法。知っとくと地味に便利ですよ！ - ラブグアバ]]
*** 再計算を自動で行わない
- 
  数式->計算方法の設定->手動、を選択。
  Select FORMULAS->Calculation Options->Manual
  [[http://ameblo.jp/sugoikaizen/entry-12031805139.html][Excelがいちいち再計算で止まってしまう現象を止める方法 - エクセルセミナー研修のすごい改善～Excel社員研修と業務効率化]]

*** 高速vlookup
- 
  大体以下のような感じ。
  =IF(INDEX(Sheet1!$A$2:$A$200001,MATCH($A2,Sheet1!$A$2:$A$200001,1),1)=$A2,VLOOKUP($A2,Sheet1!$A$2:$B$200001,2,TRUE),NA())
  INDEX,MATCHをTRUEで近似値で行い、それが元値と一致した場合のみvlookupで近似値計算。
  近似値計算の方が早いため。ただし対象を昇順に並べておく必要あり。
  別にINDEX, MATCHを二回やってもよいと思われる。

  [[http://excel-ubara.com/excel3/EXCEL019.html][【奥義】大量データでの高速VLOOKUP - エクセルの神髄]]

*** シート名の変更
- ショートカット : Alt,O,H,R
- シートをダブルクリック
*** ワークシートの再表示(unhide)
- 
  基本的に大したショートカットもない。
  Alt->H->O->U->Hでメニューバーをたどることはできる。
  （Home, Format, Hide & Unhide, Unhide sheet)

- 一括再表示
  VBAを使う。
  - 例)
    For Each Sh In ActiveWorkbook.Sheets
        Sh.Visible = True
    Next Sh
