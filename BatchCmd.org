* Batch

** Command

*** Choice

- choice[.exe] [/C <choices>] [/N] [/CS] [/T nnnn [/D c]] [/M <message>]
  - /C <choices>
    選択肢となる文字列を指定する。
  - /N
    選択肢と「？」を表示させない。
  - /CS
    選択肢の大文字小文字を区別する。
  - /T
    選択する時間を設定する。nnnnは制限時間の秒数。
  - /D
    Tで指定した時間が経過した際に選択される選択肢を指定する。
  - /M <message>
    メッセージを表示する。

- 1番目の選択肢を選ぶと1、n番目の選択肢を選ぶとnが終了コード（エラーコード）が返される。
  Ctrl+Cなどが押されると0、エラー時には255が返される。

- ex) choice /C YN /M "続行しますか"
      ⇒続行しますか [Y,N]?


*** DEFINED

- 環境変数が設定されているかチェックするには、DEFINEDを使う。

- ex) IF DEFINED ENV echo OK

[[http://orangeclover.hatenablog.com/entry/20110127/1296135692][バッチファイル/コマンドプロンプトで環境変数が設定されているかチェックする方法]]


** memo

*** IF文の複数条件指定

ANDやORに相当する機能はない。ただし、AND条件であればIF文を並べて記述できる。
ex:) IF %A% == 1 IF %B% == 2 (
         REM 1かつ2のAND条件
     ) ELSE (
         それ以外
     )

[[http://capm-network.com/?tag=Windows%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%88%B6%E5%BE%A1%E6%A7%8B%E6%96%87][CapmNetwork Windowsバッチファイル制御構文]]


*** 処理の途中で改行を入れる

バッチファイルでのエスケープシーケンスは「^(hat)」なので、
改行前に^をおくと複数行を1行として扱える。
ex:) IF %ABCDEFGHIJKLM% ==1 ^
     IF %NOPQRSTUVWXYZ% ==2 (
         REM 処理
     )
[[http://orangeclover.hatenablog.com/entry/20100810/1281450669][みちしるべ バッチファイルで長い1行の処理を改行を入れて複数行に分けて書きたい]]
[[http://pf-j.sakura.ne.jp/program/dos/doscmd/str_circumflex.htm][ProgrammingField DOSコマンド一覧 ^(ハット記号)]]


*** 環境変数の消し方

"SET 変数="とする。
たとえば変数XYZを初期化したければ、"set XYZ="でよい。
[[http://orangeclover.hatenablog.com/entry/20090826/1251293551][みちしるべ 3.環境変数 (1)環境変数の使い方 〜意外に削除の仕方はしらない人が多い〜 【コマンドプロンプト、バッチファイルを使わなきゃならなくなった人向けのメモ】]]


*** バッチでの標準入力待ち

"SET /P 変数=出力文字列"、という感じの構文。
たとえば"set /P var=好きな英数字を入力してください。"とすると、
"好きな英数字を入力してください。"と画面に出力された後入力待ちになり、
改行するまでの文字列がvarに格納される。
バッチファイルでユーザーに入力させた値を取得する]]


